var FDLib=(function(){var l=document;var g=function(s){if(arguments.length!=1){throw new Error("创建接口参数只能有一个,并且为数组类型")}this.methods=[];this._isInterfaceType=true;for(var r=0,q=s.length;r<q;r++){if(typeof s[r]!=="string"){throw new Error("定义接口中的方法必须为字符串类型")}this.methods.push(s[r])}};var p=false;var c="/";var o=null;var b={};var j=null;var h=[];function n(q){if(!b[q]){b[q]=true;return true}else{return false}}function e(r){var t=FDLib.JsMap[r];var s=t.path;if(!s){throw new Error("没有找到["+r+"]JS文件路径")}if(!p){var q=s.lastIndexOf(".");s=s.substring(0,q)+".min.js"}return c+s}function a(r,s){var q=document.createElement("script");q.type="text/javascript";q.src=r;if(q.readyState){q.onreadystatechange=function(){if(q.readyState=="loaded"||q.readyState=="complete"){s()}}}else{q.onload=function(){s()}}j.appendChild(q)}function f(){var q=h.shift();if(q){a(q,function(){f()})}else{d()}}function k(){j=(l.body||l.getElementsByTagName("body")[0])||l.getElementsByTagName("HEAD")[0];f()}function d(){if(o){o()}}function m(r){if(n(r)){var u=FDLib.JsMap[r];if(!u){throw new Error("没有找到名为["+r+"]的JS文件")}var t=FDLib.JsMap[r].require||[];for(var s=0,q=t.length;s<q;s++){m(t[s])}var v=e(r);h.push(v)}}var i={createInterface:function(q){return new g(q)},createClass:function(s,r,q){var t=r;window[s]=t;if(q){this.extend(t,q)}},Interface:function(s,q){var r=new g(q);r.className=s;window[s]=r;return r},Class:function(s,r,q){var w=function(){if(w.superclass){w.superclass.init.apply(this,arguments)}r.init.apply(this,arguments);this.init=function(){throw new Error("类"+this.getClassName()+"已经被初始化,调用init()无效")}};if(typeof q==="function"){var u=function(){};u.prototype=q.prototype;w.prototype=new u();w.prototype.constructor=w;w.superclass=q.prototype;if(q.prototype.constructor==Object.prototype.constructor){q.prototype.constructor=q}w.prototype._super=function(z){var y=[];for(var A=1,x=arguments.length;A<x;A++){y.push(arguments[A])}return w.superclass[z].apply(this,y)}}var t=w.prototype;for(var v in r){t[v]=r[v]}w.prototype.getClassName=function(){return s};w.impl=function(){if(arguments.length>0){var B=w.prototype;var F=B.getClassName();for(var A=0,C=arguments.length;A<C;A++){var y=arguments[A];var D=y.className;if(!y._isInterfaceType){throw new Error(F+".impl()第"+(A+1)+"个参数必须是接口类型")}for(var z=0,E=y.methods.length;z<E;z++){var x=y.methods[z];if(!B[x]||typeof B[x]!=="function"){throw new Error("类"+F+"没有实现"+D+"."+x+"()方法")}}}}return w};window[s]=w;return w},extend:function(s,q){var r=function(){};r.prototype=q.prototype;s.prototype=new r();s.prototype.constructor=s;s.superclass=q.prototype;if(q.prototype.constructor==Object.prototype.constructor){q.prototype.constructor=q}},implement:function(t){for(var u=1,q=arguments.length;u<q;u++){var v=arguments[u];if(!v._isInterfaceType){throw new Error("类必须实现接口类型")}for(var s=0,r=v.methods.length;s<r;s++){var w=v.methods[s];if(!t[w]||typeof t[w]!=="function"){throw new Error("类没有实现接口中的[ "+w+" ]方法")}}}},getEl:function(q){return l.getElementById(q)},log:function(q){window.console&&window.console.log(q)},setDir:function(q){c=q;return this},openDebug:function(){p=true;return this},importJS:function(r){if(typeof r==="string"){m(r)}else{for(var s=0,q=r.length;s<q;s++){m(r[s])}}scriptCount=h.length;return this},loadJs:function(q,r){this.importJS(q);o=r;k()},init:function(q){o=q;k()},addHoverEffect:function(r,q){q=q||"ui-state-hover";FDLib.event.addEvent(r,"mouseover",function(s){FDLib.dom.addClass(this,q)});FDLib.event.addEvent(r,"mouseout",function(s){FDLib.dom.removeClass(this,q)})}};return i})();var FDField=FDLib.createInterface(["getValue","setValue","getData","validate","disable","enable","render","addEvent","reset"]);var FDControl=FDLib.createInterface(["hide","show"]);FDControl.controlCount=0;FDControl.generateCount=function(){return FDControl.controlCount++};FDLib.util=(function(){var c=Object.prototype,g="[object Array]",d="[object Function]",f=document,b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"};var e=null;function a(){if(!e){var n={};var m=location.search;if(m&&m.length>=1){m=m.substring(1);var l=m.split("&");for(var j=0;j<l.length;j++){var o=l[j].indexOf("=");if(o==-1){continue}var h=l[j].substring(0,o);var k=l[j].substring(o+1);k=decodeURIComponent(k);n[h]=k}}e=n}return e}return{isArray:function(h){return c.toString.apply(h)===g},isBoolean:function(h){return typeof h==="boolean"},isFunction:function(h){return(typeof h==="function")||c.toString.apply(h)===d},isNull:function(h){return h===null},isNumber:function(h){return typeof h==="number"&&isFinite(h)},isObject:function(h){return(h&&(typeof h==="object"||this.isFunction(h)))||false},isString:function(h){return typeof h==="string"},isUndefined:function(h){return typeof h==="undefined"},escapeHTML:function(h){return h.replace(/[&<>"'\/`]/g,function(i){return b[i]})},apply:function(i,j){if(i&&j&&typeof j=="object"){for(var h in j){i[h]=j[h]}}return i},clone:function(n){var j;if(this.isObject(n)){j={};for(var l in n){j[l]=this.clone(n[l])}}else{if(this.isArray(n)){j=[];for(var k=0,h=n.length;k<h;k++){var m=n[k];j[k]=this.clone(m)}}else{j=n}}return j},each:function(j,m){for(var l=0,h=j.length;l<h;l++){var k=m(j[l],l);if(!FDLib.util.isUndefined(k)){return k}}},contains:function(h,i){return this.indexOf(h,i)>=0},indexOf:function(k,l){if(l&&this.isArray(k)){for(var j=0,h=k.length;j<h;j++){if(l==k[j]){return j}}}return -1},formatSize:function(h){return parseInt(h.toString().replace(/\D*/g,""))},getPX:function(h){h=this.formatSize(h);if(h&&h>0){return h+"px"}return""},readCookie:function(h){var j="";var i=h+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(i);if(offset!=-1){offset+=i.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length}j=unescape(document.cookie.substring(offset,end))}}return j},writeCookie:function(j,k,h){var i="";if(h!=null){i=new Date((new Date()).getTime()+h*3600000);i="; expires="+i.toGMTString()}document.cookie=j+"="+escape(k)+i},getParam:function(h){return a()[h]}}})();FDLib.dom={wrap:function(d,b){var c=b;if(FDLib.util.isString(b)){if(document.createRange){var a=document.createRange();a.selectNodeContents(d);c=a.createContextualFragment(b).firstChild}else{c=document.createElement(b)}}d.parentNode.replaceChild(c,d);c.appendChild(d);return c},hideDom:function(a){if(a){a.style.display="none"}},showDom:function(a){if(a){a.style.display=""}},addClass:function(g,f){if(typeof f=="string"){var e=(f||"").split(/\s+/);var b=(g.className).toString().split(/\s+/);for(var c=0,a=e.length;c<a;c++){var d=e[c];if(this.hasClass(g,d)){continue}if(g.nodeType==1){b.push(d)}}g.className=b.join(" ")}},removeClass:function(h,g){if(h.nodeType==1){var f=(g||"").split(/\s+/);var b=(h.className).toString().split(/\s+/);for(var d=0,a=f.length;d<a;d++){var e=f[d];for(var c=b.length-1;c>=0;c--){if(b[c]==e){b[c]="";break}}}h.className=b.join(" ")}},hasClass:function(d,b){var c=(d.className).toString().split(/\s+/);for(var a=c.length-1;a>=0;a--){if(c[a]==b){return true}}return false},bindDomStyle:function(c,b){for(var a in b){c.style[a]=b[a]}},getOffsetX:function(b){var d=b.offsetLeft;var c=b.offsetParent;while(c!==null){d+=c.offsetLeft;c=c.offsetParent}if(document.compatMode=="BackCompat"){var a=document.body.scrollLeft}else{var a=document.documentElement.scrollLeft}return d-a},getOffsetY:function(a){var d=a.offsetTop;var b=a.offsetParent;while(b!==null){d+=b.offsetTop;b=b.offsetParent}if(document.compatMode=="BackCompat"){var c=document.body.scrollTop}else{var c=document.documentElement.scrollTop}return d-c},getOffset:function(a){return{left:this.getOffsetX(a),top:this.getOffsetY(a)}},getChildNodes:function(b,a){return b.getElementsByTagName(a)},removeDom:function(a){if(a&&a.parentNode){a.parentNode.removeChild(a)}}};var FDComponent=function(a){FDLib.implement(this,FDControl);this.options=FDLib.util.apply(this.getOptions(),a);this.contentDoms=this.refreshContent();this.render();this.initEvent();this.setBounds(this.options.width,this.options.height)};FDComponent.prototype={getOptions:function(){return{domId:null,label:"",labelAlign:"right",labelValign:"middle",name:"",width:"",height:"",validates:[],renderable:true,nativeAttr:null}},initEvent:function(){},initAttr:function(){var a=this.options.nativeAttr;FDLib.util.each(this.contentDoms,function(c){for(var b in a){c.setAttribute(b,a[b])}})},render:function(b){if(b&&FDLib.util.isString(b)){this.options.domId=b}var a=FDLib.getEl(this.options.domId);this.renderToDom(a)},renderToDom:function(a){if(a&&FDRight.checkByCode(this.options.operateCode)){FDLib.util.each(this.contentDoms,function(b){a.appendChild(b)})}},initContent:function(){var a=this.buildContent();if(FDLib.util.isArray(a)){FDLib.util.each(a,function(b){this.outerDiv.appendChild(b)})}else{this.outerDiv.appendChild(a)}},refreshContent:function(){this.contentDoms=this.buildContent();if(!FDLib.util.isArray(this.contentDoms)){this.contentDoms=[this.contentDoms]}this.initAttr();return this.contentDoms},buildContent:function(){throw new Error("必须重写FDComponent.buildContent()方法")},show:function(){FDLib.util.each(this.contentDoms,function(a){a.style.display="block"})},hide:function(){FDLib.util.each(this.contentDoms,function(a){a.style.display="none"})}};FDLib.browser=(function(){var b=navigator.userAgent.toLowerCase();var a=function(c){return c.test(b)};return{isOpera:function(){return a(/opera/)},isIE:function(){return !this.isOpera()&&a(/msie/)},isWin:function(){return a(/windows|win32/)},isMac:function(){return a(/macintosh|mac os x/)},isKHTML:function(){return b.indexOf("khtml")>-1||b.indexOf("konqueror")>-1||b.indexOf("applewebkit")>-1},isMoz:function(){return b.indexOf("gecko")>-1&&!this.isKHTML()}}})();FDLib.event={addEvent:function(a,e,c){var d=this;var b=function(f,g){return function(){var h=d.getEvent();f.call(g,h)}};if(a.addEventListener){this.addEvent=function(f,h,g){f.addEventListener(h,b(g,f),false)}}else{if(a.attachEvent){this.addEvent=function(f,h,g){f.attachEvent("on"+h,b(g,f))}}else{this.addEvent=function(f,h,g){f["on"+h]=b(g,f)}}}this.addEvent(a,e,c)},addBatchEvent:function(c){var b=this;var f=c.superDom,d=c.tagName,a=c.eventName,e=c.handler;this.addEvent(f,a,function(){var h=b.getEvent();var g=h.target;if(g.tagName!==d){return}e(g);h.preventDefault();h.stopPropagation()})},removeEvent:function(a,c,b){if(a.removeEventListener){this.removeEvent=function(d,f,e){d.removeEventListener(f,e,false)}}else{if(a.detachEvent){this.removeEvent=function(d,f,e){d.detachEvent("on"+f,e)}}else{this.removeEvent=function(d,f,e){d["on"+f]=null}}}this.removeEvent(a,c,b)},formatEvent:function(a){if(FDLib.browser.isIE()){a.charCode=(a.type=="keypress")?a.charCode:0;a.eventPhase=2;a.isChar=(a.charCode>0);a.pageX=a.clientX+document.body.scrollLeft;a.pageY=a.clientY+document.body.scrollTop;a.preventDefault=function(){this.returnValue=false};if(a.type=="mouseout"){a.relateTarget=a.toElement}else{if(a.type=="mouseover"){a.relateTarget=a.fromElement}}a.stopPropagation=function(){this.cancelBubble=true};a.target=a.srcElement;a.timestamp=(new Date()).getTime()}return a},getEvent:function(){if(window.event){return this.formatEvent(window.event)}else{return this.getEvent.caller.arguments[0]}},registClickOtherHide:function(c,b){var a=this;this.addEvent(document,"click",function(){var f=a.getEvent();var d=f.target;while(d){if(d!=document){if(d===b||d===c){b.style.display="block";return}d=d.parentNode}else{b.style.display="none";return}}})}};var FDTag={DIV:"div",EM:"em",A:"a",INPUT:"input",TEXTAREA:"textarea",SPAN:"span",UL:"ul",LI:"li",TABLE:"table",TBODY:"tbody",IFRAME:"iframe",TH:"th",LABEL:"label",SELECT:"select",BUTTON:"button"};var FDValidateStore=(function(){var b=/^[1-9]\d*$/,h=/^(0|([1-9]\d*))$/,a=/^(((0|([1-9]\d*))[\.]?[0-9]+)|[1-9])$/,i=/^-?[0-9]{1,4}([.]{1}[0-9]{1,})?$/,g=/^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$/,e=/^[0-9]{1,4}([.]{1}[0-9]{1,})?$/,f=/^\s*[_a-zA-Z0-9\-]+(\.[_a-zA-Z0-9\-]*)*@[a-zA-Z0-9\-]+([\.][a-zA-Z0-9\-]+)+\s*$/,d=/^\s*(\+86)*0*1(3|5|8)\d{9}\s*$/,c=/\(?0\d{2}[) -]?\d{8}/;return{positiveInt:function(j){return b.test(j)},naturalNum:function(j){return h.test(j)},positiveNum:function(j){return a.test(j)},floatNum:function(j){return i.test(j)},positiveFloatNum:function(j){return g.test(j)},notNegativeFloatNum:function(j){if(j===0){return true}return e.test(j)},email:function(j){return f.test(j)},mobile:function(j){return d.test(j)},tel:function(j){return c.test(j)}}})();var FDValidate=function(a){this.options=FDLib.util.apply(this.getOptions(),a);this.msgDom=FDLib.getEl(this.options.msgId)};FDValidate.prototype={getOptions:function(){return{rule:{},msgId:"",errorMsg:"",successMsg:"",errorClass:"",successClass:"",validateHandler:null}},setMsgId:function(a){this.options.msgId=a;this.msgDom=FDLib.getEl(this.options.msgId)},showErrorMsg:function(a){if(this.options.errorClass){this.msgDom.className="";FDLib.dom.addClass(this.msgDom,this.options.errorClass)}if(this.msgDom){this.msgDom.innerHTML=a||this.options.errorMsg}},showSuccessMsg:function(a){if(this.options.successClass){this.msgDom.className="";FDLib.dom.addClass(this.msgDom,this.options.successClass)}if(this.msgDom){this.msgDom.innerHTML=a||this.options.successMsg}},validate:function(f){if(typeof this.options.validateHandler==="function"){var b=this.options.validateHandler(f);if(!b){this.showErrorMsg()}return b}var e=this.options.rule;for(var d in e){var a=this.getValueLength(f);if(a===0){if(this.options.rule.notNull){this.showErrorMsg();return false}return true}if(!this.validateLength(f)){return false}var c=e[d];if(c&&!this.validateItem(f,d)){return false}}this.showSuccessMsg();return true},validateLength:function(d){var a=this.getValueLength(d);var c=this.options.rule.minLength||-1;var b=this.options.rule.maxLength||-1;if(c!==-1){if(a<c){this.showErrorMsg();return false}}if(b!==-1){if(a>b){this.showErrorMsg();return false}}return true},validateItem:function(d,a){var c=FDValidateStore;var b=c[a];if(FDLib.util.isFunction(b)){if(!b(d)){this.showErrorMsg();return false}}return true},getValueLength:function(a){if(typeof a==="undefined"){return 0}if(FDLib.util.isArray(a)){return a.length}return(a+"").replace(/[^\x00-\xff]/g,"**").length}};var FDFieldComponent=function(a){FDFieldComponent.superclass.constructor.call(this,a);FDLib.implement(this,FDField);this.options.name=this.options.name||"name_"+FDControl.generateCount();this.msgId=this.options.msgId;this.controlDom;this.reset()};FDLib.extend(FDFieldComponent,FDComponent);FDFieldComponent.prototype.buildControlDom=function(){throw new Error("必须重写FDFieldComponent.getControlDom()方法")};FDFieldComponent.prototype.getOptions=function(){var a=FDFieldComponent.superclass.getOptions.call(this);return FDLib.util.apply(a,{defaultValue:""})};FDFieldComponent.prototype.addEvent=function(b,a){var c=FDLib.event;FDLib.util.each(this.getControlItems(),function(d){c.addEvent(d,b,a)})};FDFieldComponent.prototype.setEvent=function(b,a){var c=FDLib.event;FDLib.util.each(this.getControlItems(),function(d){c.setEvent(d,b,a)})};FDFieldComponent.prototype.removeEvent=function(b,a){var c=FDLib.event;FDLib.util.each(this.getControlItems(),function(d){c.removeEvent(d,b,a)})};FDFieldComponent.prototype.disable=function(){FDLib.util.each(this.getControlItems(),function(a){a.disabled="disabled";FDLib.dom.addClass(a,"ui-state-disabled")})};FDFieldComponent.prototype.enable=function(){FDLib.util.each(this.getControlItems(),function(a){a.disabled="";FDLib.dom.removeClass(a,"ui-state-disabled")})};FDFieldComponent.prototype.getControlItems=function(){if(FDLib.util.isArray(this.getControlDom())){return this.getControlDom()}else{return[this.getControlDom()]}};FDFieldComponent.prototype.getValue=function(){return this.getControlItems()[0].value};FDFieldComponent.prototype.setValue=function(a){if(a!==undefined){this.getControlItems()[0].value=a}};FDFieldComponent.prototype.getData=function(){var a=this.options.name;var b={};b[a]=this.getValue();return b};FDFieldComponent.prototype.setName=function(a){if(FDLib.util.isString(a)){this.options.name=a}};FDFieldComponent.prototype.getName=function(){return this.options.name};FDFieldComponent.prototype.reset=function(){var a=this.options.defaultValue;if(FDLib.util.isNull(a)){return}this.setValue(a)};FDFieldComponent.prototype.setWidth=function(a){a=FDLib.util.formatSize(a||"");if(a){FDLib.util.each(this.getControlItems(),function(b){b.style.width=a+"px"})}};FDFieldComponent.prototype.setHeight=function(a){a=FDLib.util.formatSize(a||"");if(a){FDLib.util.each(this.getControlItems(),function(b){b.style.height=a+"px"})}};FDFieldComponent.prototype.setBounds=function(b,a){this.setWidth(b);this.setHeight(a)};FDFieldComponent.prototype.buildContent=function(){return this.getControlDom()};FDFieldComponent.prototype.getControlDom=function(){if(!this.controlDom){this.controlDom=this.buildControlDom()}return this.controlDom};FDFieldComponent.prototype.validate=function(){var e=this.getValue();var d=this.options.validates||[];for(var c=0,a=d.length;c<a;c++){var b=d[c];var g=new FDValidate(b);g.setMsgId(this.msgId);var f=g.validate(e);if(!f){return false}}return true};var FDRight=(function(){var a={systemResourceIdName:"srId",operateCodeName:"operateCode",forceCheck:false};var b=[];return{config:function(c){FDLib.util.apply(a,c)},setData:function(c){b=c;return this},setForceCheck:function(c){a.forceCheck=!!c;return this},check:function(c,e){if(!a.forceCheck&&FDLib.util.isUndefined(e)){return true}if(!c||!e){return false}var d=b[c];return FDLib.util.contains(d,e)},checkByCode:function(e,f){var d=FDLib.util.getParam(a.systemResourceIdName);var c=this.check(d,e);if(c&&f){return f()}else{return c}}}})();var FDButton=function(a){FDButton.superclass.constructor.call(this,a);this.options=FDLib.util.apply(this.getOptions(),a);this.options.onclick=this.options.onclick||function(){};var b=this;this.addEvent("click",function(c){b.options.onclick.call(this,c)});this.setText(this.options.text)};FDLib.extend(FDButton,FDFieldComponent);FDButton.prototype.getOptions=function(){var a=FDButton.superclass.getOptions.call(this);return FDLib.util.apply(a,{text:"",onclick:null,iconConfig:{showIcon:false,rightIcon:true,iconOnly:false,iconClass:""}})};FDButton.prototype.setOnclick=function(a){if(FDLib.util.isFunction(a)){this.options.onclick=a}};FDButton.prototype.setText=function(a){this.textSpan.innerHTML=a};FDButton.prototype.buildControlDom=function(){var b=this.options.iconConfig;var d=document.createElement(FDTag.BUTTON);d.className=this._buildButtonClassName();if(b.showIcon){var a=document.createElement(FDTag.SPAN);var c=b.rightIcon?"pui-button-icon-right ui-icon ":"pui-button-icon-left ui-icon ";c+=b.iconClass;a.className=c;d.appendChild(a)}var e=this._createTextSpan();d.appendChild(e);return d};FDButton.prototype._createTextSpan=function(){this.textSpan=document.createElement(FDTag.SPAN);this.textSpan.className="pui-button-text";return this.textSpan};FDButton.prototype._buildButtonClassName=function(){var a="pui-button ui-widget ui-state-default ui-corner-all ";var c=this.options.iconConfig;if(c.showIcon){var e="pui-button-icon-only";var d="pui-button-text-icon-left";var f="pui-button-text-icon-right";if(c.iconOnly){a+=e}else{if(c.rightIcon){a+=f}else{a+=d}}}else{var b="pui-button-text-only";a+=b}return a};FDButton.prototype.initEvent=function(){FDLib.addHoverEffect(this.getControlDom())};function JString(a){this._strings=new Array;if(a&&typeof a==="string"){this._strings.push(a)}}JString.prototype.append=function(a){this._strings.push(a);return this};JString.prototype.toString=function(){return this._strings.join("")};FDLib.date={isLeapYear:function(a){return !!((a&3)==0&&(a%100||(a%400==0&&a)))},isDateStr:function(a){return !!this._parseDateStrToNum(a)},getMonthDaysArr:function(a){var b=[31,28,31,30,31,30,31,31,30,31,30,31];b[1]=this.isLeapYear(a)?29:28;return b},getEndDate:function(a,b){var c=this.getMonthDaysArr(a);return c[b-1]},parse:function(a){return new Date(this._parseDateStrToNum(a))},_parseDateStrToNum:function(a){return Date.parse(a.replace(/-/g,"/"))},format:function(b,c){var d={"M+":b.getMonth()+1,"d+":b.getDate(),"h+":b.getHours(),"m+":b.getMinutes(),"s+":b.getSeconds(),"q+":Math.floor((b.getMonth()+3)/3),S:b.getMilliseconds()};if(/(y+)/.test(c)){c=c.replace(RegExp.$1,(b.getFullYear()+"").substring(4-RegExp.$1.length))}for(var a in d){if(new RegExp("("+a+")").test(c)){c=c.replace(RegExp.$1,(RegExp.$1.length==1)?(d[a]):(("00"+d[a]).substring((""+d[a]).length)))}}return c}};var FDItem=FDLib.createInterface(["setItems","getItems"]);FDLib.string={format:function(c,b){for(var a in b){c=c.replace(new RegExp("\\{\\s*"+a+"\\s*\\}","g"),b[a])}return c},isEmptyStr:function(a){return(typeof a==="string"&&!a)}};var FDItemComponent=function(a){FDItemComponent.superclass.constructor.call(this,a);FDLib.implement(this,FDItem);this.selectItemCache={};this.domCont};FDLib.extend(FDItemComponent,FDFieldComponent);FDItemComponent.prototype.getOptions=function(){var a=FDItemComponent.superclass.getOptions.call(this);return FDLib.util.apply(a,{items:[],defaultValue:null})};FDItemComponent.prototype.setItems=function(a){if(FDLib.util.isArray(a)){this.options.items=a;this._removeOldControlDom();this.refreshContent();this.render()}};FDItemComponent.prototype.getItems=function(){return this.options.items||[]};FDItemComponent.prototype.getSelectItem=function(){var b=this.getValue();var a=FDLib.util;var c={};if(FDLib.string.isEmptyStr(b)){return c}if(a.isNumber(b)||a.isBoolean(b)||a.isString(b)){c=this._getNormalValueItem(b)}if(FDLib.util.isArray(b)){c=this._getArrayValueItem(b)}return c};FDItemComponent.prototype._getNormalValueItem=function(e){var a=FDLib.util;var c=this.getItems();var d=this.selectItemCache[e];if(d){return d}var b=this;return a.each(c,function(f){if(f.value==e){b.selectItemCache[e]=f;return f}})};FDItemComponent.prototype._getArrayValueItem=function(b){var c=b.join("-");var d=this.selectItemCache[c];if(d){return d}var a=this.getItems();var f=[];var e=FDLib.util.each;e(b,function(g){e(a,function(h){if(g==h.value){f.push(h)}})});this.selectItemCache[c]=f;return f};FDItemComponent.prototype._removeOldControlDom=function(){FDLib.dom.removeDom(this.domCont);this.controlDom=null};FDItemComponent.prototype.buildContent=function(){var b=this;var a=this.getControlDom();b.domCont=document.createElement(FDTag.DIV);var c=null;FDLib.util.each(a,function(e){c="radio_"+FDControl.generateCount();var d=document.createElement(FDTag.LABEL);e.id=c;d.setAttribute("for",c);e.style.cursor="pointer";d.style.cursor="pointer";d.innerHTML=e.text;b.domCont.appendChild(e);b.domCont.appendChild(d)});return b.domCont};var FDSelectBox=function(a){FDSelectBox.superclass.constructor.call(this,a)};FDLib.extend(FDSelectBox,FDItemComponent);FDSelectBox.prototype.getOptions=function(){var a=FDSelectBox.superclass.getOptions.call(this);return FDLib.util.apply(a,{showDefault:true,defaultItemText:"-请选择-",defaultItemValue:"",defaultValue:null})};FDSelectBox.prototype.buildControlDom=function(){var a=document.createElement(FDTag.SELECT);a.setAttribute("name",this.options.name);this._initOptions(a);return a};FDSelectBox.prototype._initOptions=function(a){var c=a.options;var b=this.getItems();if(b.length===0){b.push({text:this.options.defaultItemText,value:this.options.defaultItemValue})}if(!this.options.showDefault){var d=b.shift();this.options.defaultItemText=d.text;this.options.defaultItemValue=d.value}c.add(new Option(this.options.defaultItemText,this.options.defaultItemValue));FDLib.util.each(b,function(e){c.add(new Option(e.text,e.value))});if(FDLib.util.isNull(this.options.defaultValue)){this.options.defaultValue=this.options.defaultItemValue}};FDSelectBox.prototype.buildContent=function(){this.controlDom=this.buildControlDom();return this.getControlDom()};var FDCalendar=function(a){FDLib.implement(this,FDControl);this.options=FDLib.util.apply(this.getOptions(),a);this.dateUtil=FDLib.date;this.today=new Date();this.date=new Date();this.calendarDiv=this.buildCalandarPanel();this.table=this.buildCalendarTable();this.thead=this.table.createTHead();this.tbody=document.createElement(FDTag.TBODY);this.tfoot=this.table.createTFoot();this.table.appendChild(this.tbody);this.yearSelect=null;this.monthSelect=null;this.selectedTD;this._buildCalendarBody();this.render()};FDCalendar.FORMAT_YMD="yyyy-MM-dd";FDCalendar.FORMAT_YMDHMS="yyyy-MM-dd hh:mm:ss";FDCalendar.MONTH_ITEMS=[{text:"一月",value:"1"},{text:"二月",value:"2"},{text:"三月",value:"3"},{text:"四月",value:"4"},{text:"五月",value:"5"},{text:"六月",value:"6"},{text:"七月",value:"7"},{text:"八月",value:"8"},{text:"九月",value:"9"},{text:"十月",value:"10"},{text:"十一月",value:"11"},{text:"十二月",value:"12"}];FDCalendar.prototype={getOptions:function(){return{domId:null,weekTextArr:["日","一","二","三","四","五","六"],format:FDCalendar.FORMAT_YMD,onclick:null,onclear:null,dayRender:function(b,a){return a}}},buildCalandarPanel:function(){var a=document.createElement(FDTag.DIV);a.className="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ui-shadow";a.style.display="none";return a},show:function(a){this.setValue(a);this.calendarDiv.style.display="block"},getCalendarDom:function(){return this.calendarDiv},hide:function(){this.calendarDiv.style.display="none"},setValue:function(a){var b;if(a){b=this.dateUtil.parse(a)}else{b=new Date()}this.setValueDate(b)},setValueDate:function(a){this.date=a;this.refresh()},setYearRefresh:function(a){this.setYear(a);this.refresh()},setMonthRefresh:function(a){this.setMonth(a);this.refresh()},getValue:function(){return this.dateUtil.format(this.date,this.options.format)},getYear:function(){return this.date.getFullYear()},getMonth:function(){return this.date.getMonth()+1},getDate:function(){return this.date.getDate()},getHours:function(){return this.date.getHours()},getMinutes:function(){return this.date.getMinutes()},setYear:function(a){this.date.setYear(a)},setMonth:function(a){this.date.setMonth(a-1)},setDate:function(a){this.date.setDate(a)},setHours:function(a){this.date.setHours(a)},setMinutes:function(a){this.date.setMinutes(a)},setSeconds:function(a){this.date.setSeconds(a)},refresh:function(){this._refreshBody();this._buildCalendar()},render:function(){if(FDRight.checkByCode(this.options.operateCode)){var a=FDLib.getEl(this.options.domId)||document.body;a.appendChild(this.calendarDiv)}},getYMDData:function(){return{year:this.getYear(),month:this.getMonth(),date:this.getDate()}},_buildCalendarBody:function(){var a=this.buildYearMonthSelector();this.calendarDiv.appendChild(a);this.appendWeekTextRow(this.thead);this.calendarDiv.appendChild(this.table);var b=this.buildButtonsDiv();this.calendarDiv.appendChild(b)},_refreshBody:function(){FDLib.dom.removeDom(this.tbody);this.tbody=document.createElement(FDTag.TBODY);this.table.appendChild(this.tbody);this._initOnclickEvent();this._initMouseEvent()},buildCalendarTable:function(){var a=document.createElement(FDTag.TABLE);a.className="ui-datepicker-calendar";return a},buildButtonsDiv:function(){var a=document.createElement(FDTag.DIV);a.className="ui-datepicker-header";a.style.textAlign="center";var d=this;var c=new FDButton({text:"今天",onclick:function(){d.setToday()}});var b=new FDButton({text:"清空",onclick:function(){d._runOnclearHandler()}});c.renderToDom(a);b.renderToDom(a);return a},setToday:function(){this.setValueDate(new Date());this._runOnclickHandler()},_initOnclickEvent:function(){var a=this;FDLib.event.addBatchEvent({superDom:this.tbody,tagName:"SPAN",eventName:"click",handler:function(c){if(c&&c.innerHTML){var b=parseInt(c.innerHTML);a.onClickDate(b,c);a._runOnclickHandler()}}})},_highlightTD:function(a){FDLib.dom.addClass(a,"ui-state-hover")},_unhighlightTD:function(a){FDLib.dom.removeClass(a,"ui-state-hover")},_initMouseEvent:function(){var a=this;FDLib.event.addBatchEvent({superDom:this.tbody,tagName:"SPAN",eventName:"mouseover",handler:function(b){a._highlightTD(b)}});FDLib.event.addBatchEvent({superDom:this.tbody,tagName:"SPAN",eventName:"mouseout",handler:function(b){a._unhighlightTD(b)}})},onClickDate:function(a,b){this.setDate(a);this.activeTD(b.outer)},_runOnclickHandler:function(){var a=this.options.onclick;if(FDLib.util.isFunction(a)){a(this.getValue(),this)}},_runOnclearHandler:function(){var a=this.options.onclear;if(FDLib.util.isFunction(a)){a(this.getValue(),this)}},activeTD:function(b){var a=null;if(this.selectedTD){this.selectedTD.className="";a=this.selectedTD.inner;FDLib.dom.removeClass(a,"ui-state-highlight ui-state-active")}FDLib.dom.addClass(b,"ui-datepicker-days-cell-over  ui-datepicker-current-day ui-datepicker-today");a=b.inner;FDLib.dom.addClass(a,"ui-state-highlight ui-state-active");this.selectedTD=b},_buildCalendar:function(){var j=this;var b=this.dateUtil.getEndDate(this.getYear(),this.getMonth());var g=new Date(this.getYear(),this.getMonth()-1,1);var c=g.getUTCDay();var e=new Date();var a=1;var f=0;var h=this.tbody.insertRow(f++);for(var d=0;d<=c;d++){h.insertCell(d)}for(var d=c+1;d<=6;d++){this._buildTD(h,d,a++)}while(a<=b){var k=this.tbody.insertRow(f++);for(var d=0;d<=6&&a<=b;d++){this._buildTD(k,d,a++)}}this.initYearMonthSelect()},_buildTD:function(d,b,a){var e=d.insertCell(b);var c=document.createElement(FDTag.SPAN);c.innerHTML=this.options.dayRender(c,a);c.className="ui-state-default";c.style.textAlign="center";c.outer=e;e.inner=c;e.appendChild(c);e.style.cursor="pointer";e.style.textAlign="center";if(this._isReachToToday(a)){e.title="今天"}if(this._isSelectedDay(e)){this.activeTD(e)}},_isReachToToday:function(a){return this.today.getDate()==a&&this.getMonth()==this.today.getMonth()+1&&this.today.getFullYear()==this.getYear()},_isSelectedDay:function(b){var a=this.getDateByTD(b);return this.getDate()==a},getDateByTD:function(c){var b=c.inner;var a=null;if(b){a=parseInt(b.innerHTML)||1}return a||1},buildYearMonthSelector:function(){var a=document.createElement(FDTag.DIV);a.className="ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all";this.appendPrevMonthButton(a);this.appendNextMonthButton(a);this.appendYearMonthSelect(a);return a},appendPrevMonthButton:function(e){var c=this;var b=document.createElement(FDTag.A);b.className="ui-datepicker-prev ui-corner-all";var d=document.createElement(FDTag.SPAN);d.className="ui-icon ui-icon-circle-triangle-w";d.title="上月";FDLib.event.addEvent(d,"click",function(){var a=c.getMonth()-1;var f=c.getYear();if(a<1){f--}c.setYearMonth(f,a)});b.appendChild(d);e.appendChild(b)},appendNextMonthButton:function(e){var c=this;var b=document.createElement(FDTag.A);b.className="ui-datepicker-next ui-corner-all";var d=document.createElement(FDTag.SPAN);d.className="ui-icon ui-icon-circle-triangle-e";d.title="下月";FDLib.event.addEvent(d,"click",function(){var a=c.getMonth()+1;var f=c.getYear();if(a>12){f++}a=a>12?1:a;c.setYearMonth(f,a)});b.appendChild(d);e.appendChild(b)},setYearMonth:function(a,b){this._setNextMonthDate(a,b);this.setMonth(b);this.setYear(a);this.refresh()},appendYearMonthSelect:function(b){var a=this;var c=document.createElement(FDTag.DIV);c.className="ui-datepicker-title";this.yearSelect=new FDSelectBox({showDefault:false,items:this.buildYearItems()});this.monthSelect=new FDSelectBox({showDefault:false,items:FDCalendar.MONTH_ITEMS});this.yearSelect.addEvent("change",function(){a.setYearRefresh(this.value)});this.monthSelect.addEvent("change",function(){a.setMonthRefresh(this.value)});this.yearSelect.renderToDom(c);this.monthSelect.renderToDom(c);b.appendChild(c)},buildYearItems:function(){var a=this.options.yearItems||[];var b=this.getYear();for(var c=-10;c<=10;c++){var d=b+c;a.push({text:d,value:d})}return a},_setNextMonthDate:function(c,b){if(this.isEndDate()){var d=this._getCurrentEndDate();var a=this.dateUtil.getEndDate(c,b);this.setDate(Math.min(d,a))}},isEndDate:function(){var a=this._getCurrentEndDate();return this.getDate()==a},_getCurrentEndDate:function(){return this.dateUtil.getEndDate(this.getYear(),this.getMonth())},appendWeekTextRow:function(c){var b=this.options.weekTextArr;var a=c.insertRow(0);FDLib.util.each(b,function(f,d){var e=document.createElement(FDTag.TH);if(d==0||d==b.length-1){e.className="ui-datepicker-week-end"}e.innerHTML="<span>"+f+"</span>";a.appendChild(e)})},initYearMonthSelect:function(){this.yearSelect.setValue(this.getYear());this.monthSelect.setValue(this.getMonth())}};var FDCheckBox=function(a){FDCheckBox.superclass.constructor.call(this,a)};FDLib.extend(FDCheckBox,FDItemComponent);FDCheckBox.prototype.getOptions=function(){var a=FDCheckBox.superclass.getOptions.call(this);return FDLib.util.apply(a,{items:[],vertical:false,defaultValue:[]})};FDCheckBox.prototype.buildControlDom=function(){var b=this;var a=this.getItems();var c=[];FDLib.util.each(a,function(d){c.push(b._createCheckboxInput(d))});return c};FDCheckBox.prototype._createCheckboxInput=function(b){var a=document.createElement(FDTag.INPUT);a.setAttribute("type","checkbox");a.setAttribute("name",this.options.name);a.value=b.value;a.text=b.text;return a};FDCheckBox.prototype.setValue=function(c){var a=FDLib.util;if(!a.isArray(c)){throw new Error("方法FDCheckBox.setValue参数必须为数组类型")}var b=this.getControlItems();a.each(b,function(d){d.checked=null;a.each(c,function(e){if(d.value==e){d.checked="checked";return true}})})};FDCheckBox.prototype.getValue=function(){var a=this.getControlItems();var b=[];FDLib.util.each(a,function(c){if(c.checked){b.push(c.value)}});return b};var FDTextBox=function(a){FDTextBox.superclass.constructor.call(this,a);this.options=FDLib.util.apply(this.getOptions(),a)};FDLib.extend(FDTextBox,FDFieldComponent);FDTextBox.prototype.getOptions=function(){var a=FDTextBox.superclass.getOptions.call(this);return FDLib.util.apply(a,{defaultClassName:"pui-inputtext ui-widget ui-state-default ui-corner-all"})};FDTextBox.prototype.buildControlDom=function(){var a=document.createElement(FDTag.INPUT);a.setAttribute("type","text");a.setAttribute("name",this.options.name);a.className=this.options.defaultClassName;return a};FDTextBox.prototype.initEvent=function(){FDLib.addHoverEffect(this.getControlDom());this.addEvent("click",function(a){FDLib.dom.addClass(a.target,"ui-state-focus");a.stopPropagation()});this.addEvent("blur",function(a){FDLib.dom.removeClass(a.target,"ui-state-focus");a.stopPropagation()})};var FDDatePick=function(a){FDDatePick.superclass.constructor.call(this,a);this.options=FDLib.util.apply(this.getOptions(),a);FDDatePick.instance=this;if(!FDDatePick.calendar){FDDatePick.calendar=new FDCalendar({onclick:this.options.onclick,onclear:this.options.onclear});FDDatePick.calendar.calendarDiv.style.position="absolute";FDDatePick.calendar.calendarDiv.style.zIndex=9999;FDDatePick.calendar.hide()}this.clickTarget=FDLib.getEl("clickId")||this.getControlDom();this._registCalendar();FDDatePick.calendar._runOnclearHandler()};FDLib.extend(FDDatePick,FDTextBox);FDDatePick.prototype.getOptions=function(){var a=FDDatePick.superclass.getOptions.call(this);return FDLib.util.apply(a,{value:"",clickId:"",onclick:function(b,c){FDDatePick.instance.setValue(b);c.hide()},onclear:function(b,c){FDDatePick.instance.setValue(FDDatePick.instance.options.defaultValue);c.hide()},isShowTime:false,offsetX:0,offsetY:26,format:FDCalendar.FORMAT_YMD,defaultValue:""})};FDDatePick.prototype._registCalendar=function(){var e=this;var a=FDDatePick.calendar;var c=a.getCalendarDom();var b=this.clickTarget;var d=FDLib.event;b.style.cursor="pointer";FDLib.event.addEvent(b,"click",function(){FDDatePick.instance=e;e.showCalendar()});d.addEvent(document,"click",function(g){var f=g.target;if(b.disabled){return}while(f){if(f!=document){if(f===c||f===b){break}f=f.parentNode}else{a.hide();break}}})};FDDatePick.prototype._setPosition=function(d){var c=FDLib.dom.getOffset(d);var a=this.options;var b=FDDatePick.calendar.getCalendarDom();b.style.left=c.left+a.offsetX+"px";b.style.top=c.top+a.offsetY+"px"};FDDatePick.prototype.showCalendar=function(){this._setPosition(this.clickTarget);FDDatePick.calendar.show(this.getValue())};FDDatePick.prototype.setValue=function(b){var a=FDLib.date.isDateStr(b);if(a){FDDatePick.superclass.setValue.call(this,b)}else{FDDatePick.superclass.setValue.call(this,this.options.defaultValue)}};FDDatePick.prototype.getValue=function(){var a=FDDatePick.superclass.getValue.call(this);return FDLib.date.isDateStr(a)?a:""};FDDatePick.prototype.disable=function(){FDDatePick.superclass.disable.call(this);this.clickTarget.title=""};FDDatePick.prototype.enable=function(){FDDatePick.superclass.enable.call(this);this.clickTarget.title="点击选择时间"};var FDHidden=function(a){FDHidden.superclass.constructor.call(this,a);this.options=FDLib.util.apply(this.getOptions(),a)};FDLib.extend(FDHidden,FDFieldComponent);FDHidden.prototype.buildControlDom=function(){var a=document.createElement(FDTag.INPUT);a.setAttribute("type","hidden");a.setAttribute("name",this.options.name);return a};FDHidden.prototype.hide=FDHidden.prototype.show=FDHidden.prototype.enable=FDHidden.prototype.disable=function(){};var FDPasswordBox=function(a){FDPasswordBox.superclass.constructor.call(this,a)};FDLib.extend(FDPasswordBox,FDTextBox);FDPasswordBox.prototype.buildControlDom=function(){var a=document.createElement(FDTag.INPUT);a.setAttribute("type","password");a.setAttribute("name",this.options.name);a.className=this.options.defaultClassName;return a};var FDRadio=function(a){FDRadio.superclass.constructor.call(this,a)};FDLib.extend(FDRadio,FDItemComponent);FDRadio.prototype.getOptions=function(){var a=FDRadio.superclass.getOptions.call(this);return FDLib.util.apply(a,{vertical:false,defaultValue:""})};FDRadio.prototype.buildControlDom=function(){var b=this;var a=this.getItems();var c=[];FDLib.util.each(a,function(d){c.push(b._createRadioInput(d))});return c};FDRadio.prototype._createRadioInput=function(b){var a=document.createElement(FDTag.INPUT);a.setAttribute("type","radio");a.setAttribute("name",this.options.name);a.value=b.value;a.text=b.text;return a};FDRadio.prototype.setValue=function(b){var a=this.getControlItems();FDLib.util.each(a,function(c){c.checked="";if(c.value==b){c.checked="checked";return false}})};FDRadio.prototype.getValue=function(){var a=this.getControlItems();return FDLib.util.each(a,function(b){if(b.checked){return b.value}})};var FDTextArea=function(a){FDTextArea.superclass.constructor.call(this,a);this.options=FDLib.util.apply(this.getOptions(),a)};FDLib.extend(FDTextArea,FDTextBox);FDTextArea.prototype.getOptions=function(){var a=FDTextArea.superclass.getOptions.call(this);return FDLib.util.apply(a,{width:240,height:80,labelValign:"top"})};FDTextArea.prototype.buildControlDom=function(){var a=document.createElement(FDTag.TEXTAREA);a.setAttribute("name",this.options.name);a.className=this.options.defaultClassName;return a};var FDFormPanel=function(a){this.options=FDLib.util.apply(this.getOptions(),a);this.controls=this.options.controls};FDFormPanel.prototype={getOptions:function(){return{controls:[],url:"",grid:null,win:null,crudUrl:null,onSubmit:null}},submit:function(f){var a=this.options.onSubmit;var e=true;if(a){e=a.call(this)}if(e){var d=this.getValues();var b=this.getUrl();var c=this;FDLib.ajax.request({url:b,params:d,success:function(h){if(FDLib.util.isFunction(f)){if(h.success){f(h)}else{var g=h.message;g=g+"<br>"+c.buildValidateError(h);FDWindow.alert(g)}}}})}},buildValidateError:function(a){if(a.messages&&a.messages.length>0){var b=a.messages;return'<span style="color:red;">'+b.join("<br>")+"</span>"}else{return""}},add:function(){this.setUrl(this.getCrudUrl().add);this.reset();this.getWin().setTitle("添加");this.getWin().show()},update:function(a){this.getWin().setTitle("修改");this.setUrl(this.getCrudUrl().update);this.reset();this.setValues(a);this.getWin().show()},del:function(b){var a=this;FDWindow.confirm("确定删除这条记录?",function(c){if(c){a.setUrl(a.getCrudUrl().del);a.setValues(b);a.submit(function(){a.getWin().close();a.getGrid().reload()})}})},save:function(){var a=this.validate();if(!a){return false}var b=this;this.submit(function(){b.getGrid().refresh();b.getWin().close()})},validate:function(){for(var b=0,a=this.controls.length;b<a;b++){if(!this.controls[b].validate()){return false}}return true},setUrl:function(a){this.options.url=a},getUrl:function(){return this.options.url},getCrudUrl:function(){return this.options.crudUrl},getWin:function(){return this.options.win},getGrid:function(){return this.options.grid},getControl:function(a){return FDLib.util.each(this.controls,function(b){if(b.getName()==a){return b}})},setValues:function(b){var a=FDLib.util;if(a.isObject(b)){a.each(this.controls,function(d){var c=b[d.getName()];if(c!=undefined){d.setValue(c)}})}},getValues:function(a){var b={};FDLib.util.each(this.controls,function(c){b[c.getName()]=c.getValue()});if(a){return b[a]}return b},setData:function(a){this.setValues(a)},getData:function(a){return this.getValues(a)},reset:function(){FDLib.util.each(this.controls,function(a){a.reset()})}};var Model=FDLib.createInterface(["postData"]);var View=FDLib.createInterface(["processData"]);var Cell=FDLib.createInterface(["buildCellData"]);var FDCellView=function(b,a){FDLib.implement(this,Cell);this.options=a;this.column=b};FDCellView.prototype.buildCellData=function(d,f,e,c){var a=d[this.column.name]||"";var b=this.getStyle();if(FDLib.util.isFunction(this.column.render)){a=this.column.render(d,f,e)}f.innerHTML=a;FDLib.dom.bindDomStyle(f,b);if(this.column.textOneLine){f.style.whiteSpace="nowrap"}else{f.style.wordWrap="break-word";f.style.whiteSpace="normal"}};FDCellView.prototype.getStyle=function(){var a=this.column.style;if(!this.options.fitColumns){a=FDLib.util.apply(this.getColumnDefaultStyle(),this.column.style)}return a};FDCellView.prototype.getColumnDefaultStyle=function(){return FDLib.util.clone(this.options.columnDefaultStyle)};var FDButtonView=function(b,a){FDLib.implement(this,Cell);this.options=a;this.column=b;this.actionButtons=this.options.actionButtons};FDLib.extend(FDButtonView,FDCellView);FDButtonView.prototype.buildCellData=function(d,f,e,c){var a=this;var b=this.getStyle();FDLib.util.each(this.actionButtons,function(h){if(FDRight.checkByCode(h.operateCode)){var g=a._buildButton(h,d,e);if(g){f.appendChild(g);FDLib.dom.bindDomStyle(f,b)}}})};FDButtonView.prototype._buildButton=function(c,d,e){if(this._isShowButton(c,d,e)){var b=document.createElement(FDTag.A);b.style.marginLeft="5px";b.style.marginRight="5px";b.href="javascript:void(0)";b.innerHTML=c.text;FDLib.event.addEvent(b,"click",function(){c.onclick(d,e)});return b}};FDButtonView.prototype._isShowButton=function(c,d,e){var b=this.options.isRenderable||true;if(!b){return false}var a=FDLib.util.isFunction(c.showFun);if(a){return c.showFun(d,e)}return true};var FDHeadCellView=function(b,a){this.column=b;this.options=a;this.upTxt="▲";this.downTxt="▼";this.grid=a.getGrid()};FDLib.extend(FDHeadCellView,FDCellView);FDHeadCellView.prototype.buildCellData=function(c,b){var a=this.getStyle();c.innerHTML=this.column.text;this._buildSortButton(c);FDLib.dom.bindDomStyle(c,a)};FDHeadCellView.prototype._buildSortButton=function(b){if(this.column.sortName){this.currentSortOrder=this.grid.getSortOrder()||"DESC";var a=this._buildTagA();this._initTagAEvent(a);b.appendChild(a)}};FDHeadCellView.prototype._buildTagA=function(){var a=document.createElement(FDTag.A);a.href="javascript:void(0)";a.innerHTML=(this.currentSortOrder=="DESC")?this.downTxt:this.upTxt;return a};FDHeadCellView.prototype._initTagAEvent=function(b){var c=this;var d=this.column.sortName;FDLib.event.addEvent(b,"click",function(f){var a=f.target;if(c.currentSortOrder=="ASC"){a.innerHTML=c.downTxt;c.currentSortOrder="DESC"}else{a.innerHTML=c.upTxt;c.currentSortOrder="ASC"}c.grid.sort(d,c.currentSortOrder)})};var FDSelectHeadCellView=function(a,b){this.selectOption=a;this.options=b;this.grid=b.getGrid()};FDLib.extend(FDSelectHeadCellView,FDHeadCellView);FDSelectHeadCellView.prototype.buildCellData=function(b){if(this.selectOption.multiSelect){var a=this._buildSelector(b);if(this.selectOption.hideCheckAll){FDLib.dom.hideDom(a)}this.grid.checkAllInput=a;b.appendChild(a)}else{b.innerHTML="&nbsp;"}b.style.width="20px";b.setAttribute("align","center")};FDSelectHeadCellView.prototype._buildSelector=function(c){var b=this;var a=document.createElement(FDTag.INPUT);a.setAttribute("type","checkbox");a.style.cursor="pointer";a.onclick=function(){var d=document.getElementsByName(b.selectOption.name);var e=this.checked?"checked":"";FDLib.util.each(d,function(g,f){if(g.disabled){return}if(g.checked==e){return}g.checked=e;g.onclick()})};return a};var FDHeadView=function(a,b){this.grid=b;this.options=a;this.gridDomMap=this.options.gridDomMap;this.headCellViews=null;this._initHeadCellViews()};FDHeadView.prototype.buildHead=function(){this.gridDomMap.headThead_0=this.gridDomMap.table_1.createTHead();this._buildHeadHtml(this.gridDomMap.headThead_0)};FDHeadView.prototype._buildHeadHtml=function(b){var a=this.headCellViews;FDLib.util.each(a,function(e,c){var d=document.createElement(FDTag.TH);d.className="ui-state-default";b.appendChild(d);e.buildCellData(d,b)})};FDHeadView.prototype._initHeadCellViews=function(){this.headCellViews=[];var b=this.options;var c=b.columns;var a=this;this._addSelectView();FDLib.util.each(c,function(d){a.headCellViews.push(new FDHeadCellView(d,b))});this._addButtonView(b)};FDHeadView.prototype._addSelectView=function(){var a=this.options.selectOption;if(!a){return}if(a.multiSelect||a.singleSelect){this.headCellViews.push(new FDSelectHeadCellView(a,this.options))}};FDHeadView.prototype._addButtonView=function(a){if(a.actionButtons.length>0){this.headCellViews.push(new FDHeadCellView(this.options.actionColumnConfig,a))}};var FDPanelDomView=function(a){this.options=a;this.targetDom=this.buildTargetDom();this.initPanel();this.render()};FDPanelDomView.prototype={initPanel:function(){this.panel=this.buildPanel();this.titleBar=this.buildTitleBar();this.title=this.buildTitle();this.content=this.buildContent();this.titleBar.appendChild(this.title);if(this.options.closeable){this.closeBtn=this.buildCloseBtn();this.titleBar.appendChild(this.closeBtn)}if(this.options.toggleable){this.toggleBtn=this.buildToggleBtn();this.titleBar.appendChild(this.toggleBtn)}this.panel.appendChild(this.titleBar);this.panel.appendChild(this.content);this._initSize()},setTitle:function(a){this.title.innerHTML=a},setWidth:function(a){if(FDLib.util.isString(a)){this.content.style.width=a}},setHeight:function(a){if(FDLib.util.isString(a)){this.content.style.height=a}},setContent:function(a){this.content.innerHTML=a},render:function(a){if(FDRight.checkByCode(this.options.operateCode)){this.content.appendChild(this.targetDom);if(a){this.options.domId=a}var b=FDLib.getEl(this.options.domId)||document.body;b.appendChild(this.panel)}},close:function(){this.panel.style.display="none"},hide:function(){this.close()},show:function(){this.targetDom.style.display="block";this.panel.style.display="block"},buildTargetDom:function(){if(this.options.contentId){var a=FDLib.getEl(this.options.contentId);if(!a){throw Error("未找到"+this.options.contentId)}a.style.display="none";return a}else{throw new Error("没有指定contentId,当前contentId值为:"+this.options.contentId)}},buildPanel:function(){var a=this.createEl(FDTag.DIV,this.getPanelClassName());a.style.display="none";return a},buildTitleBar:function(){var a=this.createEl(FDTag.DIV,this.getTitleBarClassName());a.style.fontSize="12px";return a},buildTitle:function(){var a=this.createEl(FDTag.SPAN,this.getTitleClassName());a.setAttribute("unselectable","on");a.setAttribute("onselectstart","return false;");a.style.cssText="-moz-user-select:none;";if(this.options.title){a.innerHTML=this.options.title}return a},buildCloseBtn:function(){var a=this;if(this.options.closeable){var c=this.createEl(FDTag.A,this.getTitleBarBtnClassName());FDLib.event.addEvent(c,"click",function(d){a.close();d.preventDefault();d.stopPropagation()});var b=this.createEl(FDTag.SPAN,this.getCloseIconClassName());c.appendChild(b);FDLib.addHoverEffect(c);return c}else{return this._getEmptySpan()}},buildToggleBtn:function(){var b=this;if(this.options.toggleable){var c=this.createEl(FDTag.A,this.getTitleBarBtnClassName());FDLib.event.addEvent(c,"click",function(d){b.slideToggle();d.preventDefault();d.stopPropagation()});var a=this.getToggleIcon();c.appendChild(a);FDLib.addHoverEffect(c);if(this.options.isExpand){c.title="点击收缩"}else{c.title="点击展开"}return c}else{return this._getEmptySpan()}},getToggleIcon:function(){if(!this.toggleIcon){this.toggleIcon=this.createEl(FDTag.SPAN,this.getToggleIconClassName())}return this.toggleIcon},buildContent:function(){return this.createEl(FDTag.DIV,this.getContentClassName())},slideToggle:function(){if(this.isExpand()){this.collapse()}else{this.expand()}return false},expand:function(){var b=this.toggleBtn;this.content.style.display="block";this.options.isExpand=true;b.title="点击收缩";var a=this.getToggleIcon();FDLib.dom.removeClass(a,"ui-icon-plusthick");FDLib.dom.addClass(a,"ui-icon-minusthick");this.afterExpand()},unexpand:function(){this.collapse()},collapse:function(){var b=this.toggleBtn;this.content.style.display="none";this.options.isExpand=false;b.title="点击展开";var a=this.getToggleIcon();FDLib.dom.addClass(a,"ui-icon-plusthick");FDLib.dom.removeClass(a,"ui-icon-minusthick");this.afterCollapse()},afterExpand:function(){},afterCollapse:function(){},isExpand:function(){var a=this.options;var b=a.toggleable;return !b||(a.isExpand&&b)},getTitleBarBtnClassName:function(){return"pui-panel-titlebar-icon ui-corner-all ui-state-default"},getTitleClassName:function(){return"ui-panel-title"},getPanelClassName:function(){return"pui-panel ui-widget ui-widget-content ui-corner-all"},getTitleBarClassName:function(){return"pui-panel-titlebar ui-widget-header ui-helper-clearfix ui-corner-all"},getContentClassName:function(){return"pui-panel-content ui-widget-content"},getCloseIconClassName:function(){return"ui-icon ui-icon-closethick"},getToggleIconClassName:function(){return"ui-icon ui-icon-minusthick"},createEl:function(c,b){var a=document.createElement(c);a.className=b;return a},_getEmptySpan:function(){return this.createEl(FDTag.SPAN,"")},_initSize:function(){var b=this.options.width;var a=this.options.height;this.setWidth(b);this.setHeight(a)}};var FDPanel=function(b){FDLib.implement(this,FDControl);this.options=FDLib.util.apply(this.getOptions(),b);var a=this.options.view;this.viewInstance=new a(this.options);if(this.options.isLoadShow){this.show()}};FDPanel.prototype={getOptions:function(){return{domId:"",title:"",view:FDPanelDomView,isSlide:false,isExpand:true,isLoadShow:true,width:null,height:null,closeable:false,toggleable:true}},show:function(a){this.viewInstance.show();if(FDLib.util.isFunction(a)){a()}},hide:function(a){this.viewInstance.close();if(FDLib.util.isFunction(a)){a()}},close:function(a){this.hide(a)},setWidth:function(a){this.options.width=a;this.viewInstance.setWidth(a)},setHeight:function(a){this.options.height=a;this.viewInstance.setHeight(a)},setTitle:function(a){this.viewInstance.setTitle(a)},setContent:function(a){this.viewInstance.setContent(a)}};var FDDragUtil=(function(){var i=document;var g=0;var f=0;var e=0;var c=0;var j=false;var h=function(){return true};var b=function(){return false};function a(){if(i.all){i.onselectstart=b}else{i.onmousedown=b}}function d(){if(i.all){i.onselectstart=h}else{i.onmousedown=h}}return{regist:function(n,p){var m=n.style;var l=parseInt(m.width||200);var k=parseInt(m.height||30);var o=0;var q=0;p.onmousedown=function(r){a();r=r||window.event;o=i.documentElement.clientHeight||i.body.clientHeight;q=i.documentElement.clientWidth||i.body.clientWidth;j=true;g=r.clientX;f=r.clientY;e=parseInt(m.top);c=parseInt(m.left);i.onmousemove=function(w){w=w||window.event;if(j){var u=w.clientX-g;var t=w.clientY-f;var v=u+c;var s=t+e;if(v>0&&v<q-l){m.left=v+"px"}if(s>0&&s<o-k){m.top=s+"px"}}}};p.onmouseup=function(){d();if(j){j=false;g=0;f=0;e=0;c=0}}},moveToCenter:function(r,m,o){var q=i.body,k=i.documentElement;var p=k.clientHeight||q.clientHeight,t=k.clientWidth||q.clientWidth,n=k.scrollLeft||q.scrollLeft,l=t*0.35+n,s=p*0.25;if(m){l=(t*0.5-(parseInt(m))*0.5)-10}if(o){s=(p*0.5-(parseInt(o))*0.5)-50}r.style.left=l+"px";r.style.top=s+"px"},destory:function(k){k.style.cursor="default";k.onmousedown=null}}})();var FDWindowDomView=function(a){FDWindowDomView.superclass.constructor.call(this,a);this.buttonPanel=null;this._createButtons();this.setDragable();this.setPanelClick()};FDLib.extend(FDWindowDomView,FDPanelDomView);FDWindowDomView.zIndex=200;FDWindowDomView.getNextZ_Index=function(){return ++FDWindowDomView.zIndex};FDWindowDomView.prototype.show=function(b){if(this.options.modal){this.showBgModal()}this.addPanelZ_Index();FDWindowDomView.superclass.show.call(this);var a=this.options.afterShow;if(FDLib.util.isFunction(a)){a()}if(FDLib.util.isFunction(b)){b()}};FDWindowDomView.prototype.addPanelZ_Index=function(){this.panel.style.zIndex=FDWindowDomView.getNextZ_Index()};FDWindowDomView.prototype.close=function(a){this.hideBgModal();FDWindowDomView.superclass.close.call(this);if(FDLib.util.isFunction(a)){a()}};FDWindowDomView.prototype.afterExpand=function(){FDLib.dom.showDom(this.buttonPanel)};FDWindowDomView.prototype.afterCollapse=function(){FDLib.dom.hideDom(this.buttonPanel)};FDWindowDomView.prototype.hideBgModal=function(){this.getBgModal().style.display="none"};FDWindowDomView._createBgModal=function(){var a=document.createElement(FDTag.DIV);a.className="ui-widget-overlay";a.style.display="none";return a};FDWindowDomView.prototype.getBgModal=function(){if(!this.bgModal){this.bgModal=FDWindowDomView._createBgModal();document.body.appendChild(this.bgModal)}return this.bgModal};FDWindowDomView.prototype.showBgModal=function(){var h=FDWindowDomView.getNextZ_Index();var f=document;var c=f.body;var g=f.documentElement;var d=g.clientHeight||c.clientHeight;var e=g.scrollHeight||c.scrollHeight;var b=Math.max(d,e);var a=this.getBgModal();a.style.height=b+"px";a.style.zIndex=h;a.style.display="block"};FDWindowDomView.prototype.moveTo=function(b,a){this.panel.style.left=b+"px";this.panel.style.top=a+"px"};FDWindowDomView.prototype.setDragable=function(){if(this.couldMoveWindow()){FDDragUtil.regist(this.panel,this.titleBar);this.moveToCenter()}else{FDDragUtil.destory(this.titleBar)}};FDWindowDomView.prototype.setPanelClick=function(){var a=this;FDLib.event.addEvent(this.panel,"mousedown",function(b){a.addPanelZ_Index()})};FDWindowDomView.prototype._createButtons=function(){var b=this.options.buttons;var a=[];if(FDLib.util.isArray(b)){FDLib.util.each(b,function(d,c){if(!(d instanceof FDButton)){d=new FDButton(d);b[c]=d}a.push(d)});this._appendButtons(a)}};FDWindowDomView.prototype._appendButtons=function(b){var a=this;if(b.length>0){if(!this.buttonPanel){this.buttonPanel=this.createEl(FDTag.DIV,this.getButtonPanelClassName());this.panel.appendChild(this.buttonPanel)}this.buttonPanel.innerHTML="";FDLib.util.each(b,function(c){c.renderToDom(a.buttonPanel)})}};FDWindowDomView.prototype.moveToCenter=function(){var b=this.options.width;var a=this.options.height;FDDragUtil.moveToCenter(this.panel,b,a)};FDWindowDomView.prototype.couldMoveWindow=function(){return this.options.dragable};FDWindowDomView.prototype.getTitleBarBtnClassName=function(){return"pui-dialog-titlebar-icon pui-dialog-titlebar-close ui-corner-all"};FDWindowDomView.prototype.getTitleClassName=function(){return"pui-dialog-title"};FDWindowDomView.prototype.getPanelClassName=function(){var a="pui-dialog ui-widget ui-widget-content ui-corner-all pui-shadow";if(this.options.dragable){a+=" ui-draggable"}return a};FDWindowDomView.prototype.getTitleBarClassName=function(){return"pui-dialog-titlebar ui-widget-header ui-helper-clearfix ui-corner-top"};FDWindowDomView.prototype.getContentClassName=function(){return"pui-dialog-content ui-widget-content"};FDWindowDomView.prototype.getCloseIconClassName=function(){return"ui-icon ui-icon-close"};FDWindowDomView.prototype.getButtonPanelClassName=function(){return"pui-dialog-buttonpane ui-widget-content ui-helper-clearfix"};var FDWindow=function(a){FDWindow.superclass.constructor.call(this,a);FDLib.implement(this,FDControl)};FDLib.extend(FDWindow,FDPanel);FDWindow.prototype.getOptions=function(){var a=FDWindow.superclass.getOptions.call(this);return FDLib.util.apply(a,{domId:"",title:"",buttons:[],view:FDWindowDomView,closeable:true,dragable:true,modal:true,afterShow:null,afterClose:null,isLoadShow:false,toggleable:false})};FDWindow.prototype.getButtons=function(){return this.options.buttons};FDWindow.prototype.moveToCenter=function(){this.viewInstance.moveToCenter()};FDWindow.prototype.moveTo=function(b,a){this.viewInstance.moveTo(b,a)};FDWindow.confirm=(function(){var b=null;var e=null;var a=null;var d={title:"提示",width:"220px",yesText:"确定",noText:"取消"};return function(i,j,g){var h=FDLib.util.clone(d);g=FDLib.util.apply(h,g);c(i,g,j);a.show()};function c(h,g,i){if(!a){b=new FDButton();e=new FDButton();a=new FDWindow({contentId:f(),closeable:false,buttons:[b,e]})}a.setTitle(g.title);a.setContent(h||"");a.setWidth(g.width);a.setHeight(g.height);b.setText(g.yesText);e.setText(g.noText);b.setOnclick(function(){i&&i(true);a.close()});e.setOnclick(function(){i&&i(false);a.close()})}function f(){var h=document.createElement(FDTag.DIV);var g="confirmWin_"+FDControl.generateCount();h.setAttribute("id",g);document.body.appendChild(h);return g}})();FDWindow.alert=(function(){var b=null;var a=null;var d={title:"提示",width:"220px",yesText:"确定"};return function(h,i,f){var g=FDLib.util.clone(d);f=FDLib.util.apply(g,f);c(h,f,i);a.show()};function c(g,f,h){if(!a){b=new FDButton();a=new FDWindow({contentId:e(),closeable:false,buttons:[b]})}a.setTitle(f.title);a.setContent(g||"");a.setWidth(f.width);a.setHeight(f.height);b.setText(f.yesText);b.setOnclick(function(){h&&h();a.close()})}function e(){var g=document.createElement(FDTag.DIV);var f="alertWin_"+FDControl.generateCount();g.setAttribute("id",f);document.body.appendChild(g);return f}})();var FDTabView=function(a,b){this.options=a;this.liStore={};this.tab=b;this.tabDiv=document.createElement(FDTag.DIV);this.tabDiv.className="pui-tabview ui-widget ui-widget-content ui-corner-all ui-hidden-container pui-tabview-top";this.ul=document.createElement(FDTag.UL);this.ul.className="pui-tabview-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all";this.ul.style.height="32px";this.tabContent=document.createElement(FDTag.DIV);this.tabContent.className="pui-tabview-panels";this.tabDiv.appendChild(this.ul);this.tabDiv.appendChild(this.tabContent);this.checkedItem=null;this._buildTabEvent()};FDTabView.prototype={buildTab:function(a){this._buildTabItem(a);this._renderToDesDom()},show:function(){this.tabDiv.style.display="block"},hide:function(){this.tabDiv.style.display="none"},disable:function(b){this._selectOtherItem(b);b.disable=true;var a=this._getLiByValue(b.value);a.className=this._getDisabledClassName()},enable:function(b){b.disable=false;var a=this._getLiByValue(b.value);a.className=this._getLiClassName()},_getDisabledClassName:function(){return"ui-state-disabled"},removeAll:function(){this._hideAllItemContent();this.ul.innerHTML="";this.liStore={}},doRemoveItem:function(b){var c=b.value;this._hideItemContent(b);var a=this._getLiByValue(c);a.parentNode.removeChild(a);this._clearLiStore(c)},removeItem:function(a){if(this._isAbleOperate(a)){this._selectOtherItem(a);this.doRemoveItem(a)}},showItemByValue:function(b){var a=this._getItemByValue(b);if(a){if(this._isAbleOperate(a)){this._processClickEvent(a)}if(this._isAbleOperate(a)&&!this.isChecked(a)){this._selectItem(a);this._processChangeEvent(a)}this._refresh(a)}},_unselectAllItems:function(){var a=this._getItemStore();for(var c in a){var b=a[c];if(this._isAbleOperate(b)){this._unselectItem(b)}}},_isAbleOperate:function(a){return a&&!a.disable},_selectItem:function(a){if(a){this._unselectAllItems();a.checked=true;FDLib.dom.addClass(this._getLiByValue(a.value),this._getSelectClassName());this._showItemContent(a)}},_unselectItem:function(a){a.checked=false;FDLib.dom.removeClass(this._getLiByValue(a.value),this._getSelectClassName());this._hideItemContent(a)},isChecked:function(a){return a&&a.checked},_getSelectClassName:function(){return"pui-tabview-selected ui-state-active"},_getLiClassName:function(){return"ui-state-default ui-corner-top"},_selectOtherItem:function(d){var b=this._getLiByValue(d.value);if(this.isChecked(d)){var a=b.previousSibling||b.nextSibling;if(a){var c=a.getAttribute("value");this.showItemByValue(c)}}},_renderToDesDom:function(){if(FDRight.checkByCode(this.options.operateCode)){var a=FDLib.getEl(this.options.domId);a.appendChild(this.tabDiv);this._selectItem(this.checkedItem||this.options.items[0])}},_buildTabItem:function(b){var a=this;FDLib.util.each(b,function(d){var c=a._buildLI(d);a.ul.appendChild(c);a._storeLI(c,d.value);a._buildItemContent(d)})},_storeLI:function(a,b){this.liStore[b]=a},_buildLI:function(b){var a=document.createElement(FDTag.LI);a.className=this._getLiClassName();a.setAttribute("value",b.value);a.innerHTML=FDLib.string.format(FDTabView.aTemplate,{text:b.text});this._addHoverEffect(a,b);if(b.closeable){this._buildCloseButton(a)}if(b.checked){this.checkedItem=b}return a},_addHoverEffect:function(a,d){var b="ui-state-hover";var c=this;FDLib.event.addEvent(a,"mouseover",function(){if(c._isAbleOperate(d)){FDLib.dom.addClass(a,b)}});FDLib.event.addEvent(a,"mouseout",function(){FDLib.dom.removeClass(a,b)})},_buildCloseButton:function(a){var b=document.createElement(FDTag.SPAN);b.className="ui-icon ui-icon-close";a.appendChild(b)},_buildItemContent:function(b){var a=b.contentDiv;a.className="pui-tabview-panel ui-widget-content ui-corner-bottom";this.tabContent.appendChild(a);if(b.checked){this._showItemContent(b)}else{this._hideItemContent(b)}},_clearLiStore:function(a){delete this.liStore[a]},_buildTabEvent:function(){var b=this;var a=this.options.isHover?"mouseover":"click";FDLib.event.addBatchEvent({superDom:this.ul,tagName:"A",eventName:a,handler:function(c){b._showItemHandler(c)}});FDLib.event.addBatchEvent({superDom:this.ul,tagName:"SPAN",eventName:"click",handler:function(c){b._closeItemHandler(c)}})},_showItemHandler:function(c){var a=c.parentNode;var b=a.getAttribute("value");this.showItemByValue(b)},_closeItemHandler:function(c){var a=c.parentNode;var b=a.getAttribute("value");if(this._isAbleOperate(this._getItemByValue(b))){this.tab.removeItemByValue(b)}},_processClickEvent:function(b){var a=b.onclick;if(FDLib.util.isFunction(a)){a(this.tab,b)}},_processChangeEvent:function(b){var a=b.onchange;if(FDLib.util.isFunction(a)){a(this.tab,b)}},_refresh:function(b){if(this._hasIframe(b)){var a=b.iframe;if(this._isNeedRefresh(a,b)){this._refreshIFrame(a,b)}}},_showItemContent:function(a){a.contentDiv.style.display="block"},_hideItemContent:function(a){a.contentDiv.style.display="none"},_hideAllItemContent:function(){var a=this._getItemStore();for(var b in a){this._hideItemContent(a[b])}},_hasIframe:function(a){return a.iframe},_isFirstLoad:function(a){return !a.src},_refreshIFrame:function(a,b){a.src=b.url},_isNeedRefresh:function(a,b){if(this._isFirstLoad(a)){return true}return(FDLib.util.isString(b.url)&&b.url&&b.isRefresh)},_getItemStore:function(){return this.options.itemStore},_getItemByValue:function(a){return this._getItemStore()[a]},_getLiByValue:function(a){return this.liStore[a]}};FDTabView.aTemplate='<a href="javascript:void(0);">{text}</a>';var FDTab=function(a){FDLib.implement(this,FDControl);this.options=FDLib.util.apply(this.getOptions(),a);this.options.itemStore={};this.tabInstance=new this.options.view(this.options,this);this._buildTab(this.options.items)};FDTab.prototype={getOptions:function(){return{domId:"",items:[],isHover:false,view:FDTabView}},show:function(){this.tabInstance.show()},hide:function(){this.tabInstance.hide()},setValue:function(a){this.tabInstance.showItem(a)},setItems:function(a){this.removeAll();this.options.items=a;this._buildTab(a)},removeAll:function(){this.tabInstance.removeAll();this._resetData()},removeItemByValue:function(b){var a=this.getItemByValue(b);this.removeItem(a)},removeItemByIndex:function(a){var b=this.getItemByIndex(a);this.removeItem(b)},removeItem:function(a){if(a){this.tabInstance.removeItem(a);this._delItemDataByValue(a.value)}},addItem:function(a){this.addItems([a])},addItems:function(a){if(FDLib.util.isArray(a)){this.options.items=this.options.items.concat(a);this._buildTab(a)}},getItemByValue:function(a){return this.options.itemStore[a]},selectItemByValue:function(a){this.tabInstance.showItemByValue(a)},selectItemByIndex:function(a){var b=this.getItemByIndex(a);if(b){this.selectItemByValue(b.value)}},disableByValue:function(b){var a=this.getItemByValue(b);this.disable(a)},disableByIndex:function(a){var b=this.getItemByIndex(a);this.disable(b)},enableByValue:function(b){var a=this.getItemByValue(b);this.enable(a)},enableByIndex:function(a){var b=this.getItemByIndex(a);this.enable(b)},disable:function(a){if(a){this.tabInstance.disable(a)}},enable:function(a){if(a){this.tabInstance.enable(a)}},getItemByIndex:function(a){return this.options.items[a]},_initItems:function(b){var a=this;var c=this._refreshPermissionItems(b);FDLib.util.each(c,function(d){d=a._checkValueAndContentId(d);d=a._checkContentDiv(d);a._storeItem(d)});return c},_refreshPermissionItems:function(a){var b=[];FDLib.util.each(a,function(c){FDRight.checkByCode(c.operateCode,function(){b.push(c)})});this.options.items=b;return b},_buildTab:function(a){var b=this._initItems(a);this.tabInstance.buildTab(b)},_resetData:function(){this.options.itemStore={};this.options.item=[]},_delItemDataByValue:function(c){var b=0;var a=this.options.items;FDLib.util.each(a,function(e,d){if(e.value==c){b=d;return false}});this._delItemData(b);this._delItemStoreByValue(c)},_delItemData:function(b){var a=this.options.items;if(a.length>b){a.splice(b,1)}},_delItemStoreByValue:function(a){delete this.options.itemStore[a]},_storeItem:function(a){this.options.itemStore[a.value]=a},_checkValueAndContentId:function(c){var a=FDLib.util;var b=FDControl.generateCount();if(a.isUndefined(c.value)){c.value="tabValue_"+b}if(a.isUndefined(c.contentId)){c.contentId="tabContId_"+b}return c},_checkContentDiv:function(c){if(FDLib.util.isUndefined(c.content)){c.content=""}var d=c.contentId,b=c.content;var a=null;if(d&&FDLib.util.isString(d)){a=FDLib.getEl(d)}if(!a){a=this._buildContentDiv(c)}c.contentDiv=a;return c},_buildContentDiv:function(b){var c=b.contentId;var a=document.createElement(FDTag.DIV);a.setAttribute("id",c);a.innerHTML=b.content;this._buildIFrame(a,b);return a},_buildIFrame:function(c,d){var a=d.url;if(FDLib.util.isString(a)&&a){var b=document.createElement(FDTag.IFRAME);b.style.cssText="width:100%;height:100%;border:0px;";d.iframe=b;c.style.height="100%";c.appendChild(b)}}};var FDSettingView=function(a){this.options=a;this.settingDiv=document.createElement(FDTag.DIV);this.settingDiv.id=this.options.domId+"_setting";document.body.appendChild(this.settingDiv);this.gridDom=FDLib.getEl(this.options.domId);this.grid=a.getGrid();this.settingWin=this._createSettingWin();this.tab=this._createTab();this.checkbox;var c=this.options.afterSearch||function(){};var b=this;this.options.afterSearch=function(){c(a.getGrid(),a);b.init()}};FDSettingView.prototype={_createSettingWin:function(){var a=new FDWindow({contentId:this.settingDiv.id,title:"设置项",modal:true,buttons:[new FDButton({text:"关闭",onclick:function(){a.close()}})]});return a},_createTab:function(){var a=document.createElement(FDTag.DIV);a.id=this.options.domId+"_tab";this.settingDiv.appendChild(a);var b=new FDTab({domId:a.id,items:this._getTabItems()});return b},_getTabItems:function(){var a=this._createColumnSelect();return[{text:"列显示",value:1,contentId:a,checked:true}]},_createColumnSelect:function(){var a=document.createElement(FDTag.DIV);var b=this.options.domId+"_colSelectId";a.id=b;document.body.appendChild(a);this._createCheckboxes(a);return b},_createCheckboxes:function(e){var c=this.options.columns;var b=this._isHasSelectRowAbility();var a=[];var f=[];FDLib.util.each(c,function(j,h){var g=b?(h+1):h;a.push({text:j.text||"#",value:g});f.push(g)});this.checkbox=new FDCheckBox({items:a,defaultValue:f});this.checkbox.renderToDom(e);var d=this;this.checkbox.addEvent("click",function(){var h=this.value;var g=this.checked;d.columnSelectorHandler(h,g)})},_isHasSelectRowAbility:function(){return this.grid.isSelectStatus()},init:function(){var a=this.checkbox.getControlItems();var b=this;FDLib.util.each(a,function(e){var d=e.value;var c=e.checked;b.columnSelectorHandler(d,c)})},columnSelectorHandler:function(b,d){var e=this.grid.getThead();var a=e.getElementsByTagName("th");var c=this.grid.getTableTR();this.toggleHeadColumn(a,b,d);this.toggleBodyColumn(c,b,d)},toggleHeadColumn:function(a,c,b){var d=a[c];if(b){FDLib.dom.showDom(d)}else{FDLib.dom.hideDom(d)}},toggleBodyColumn:function(a,c,b){FDLib.util.each(a,function(d){var e=d.cells[c];if(b){FDLib.dom.showDom(e)}else{FDLib.dom.hideDom(e)}})},showWin:function(){this.settingWin.show()}};var FDPaginationView=function(a,b){this.grid=b;this.options=a;this.gridDomMap=this.options.gridDomMap;this.settingView=new FDSettingView(this.options);this.paginInfoDiv;this.firstBtn=null;this.prevBtn=null;this.nextBtn=null;this.lastBtn=null};FDPaginationView.prototype.refreshPaginationInfo=function(a){if(this.options.showPaging){this.options.total=parseInt(a[GlobalParams.serverTotalName]||0);this.options.pageIndex=parseInt(a[GlobalParams.serverPageIndexName]||1);this.options.pageSize=parseInt(a[GlobalParams.serverPageSizeName]||10);this.options.pageCount=FDPaginationView.calcPageCount(this.options.pageSize,this.options.total);this.paginInfoDiv.innerHTML="&nbsp;&nbsp;第"+this.options.pageIndex+"/"+this.options.pageCount+"页，共"+this.options.total+"条数据&nbsp;&nbsp;";this.pageSizeSelect.setValue(this.options.pageSize);this._initBtnState()}};FDPaginationView.calcPageCount=function(a,b){return a==0?1:parseInt((b+a-1)/a)};FDPaginationView.prototype._initBtnState=function(a){if(this.options.pageIndex==1){FDLib.dom.addClass(this.firstBtn,"ui-state-disabled");FDLib.dom.addClass(this.prevBtn,"ui-state-disabled")}else{FDLib.dom.removeClass(this.firstBtn,"ui-state-disabled");FDLib.dom.removeClass(this.prevBtn,"ui-state-disabled")}if(this.options.pageIndex==this.options.pageCount){FDLib.dom.addClass(this.nextBtn,"ui-state-disabled");FDLib.dom.addClass(this.lastBtn,"ui-state-disabled")}else{FDLib.dom.removeClass(this.nextBtn,"ui-state-disabled");FDLib.dom.removeClass(this.lastBtn,"ui-state-disabled")}};FDPaginationView.prototype.hide=function(){if(this.gridDomMap.pageDiv_3){FDLib.dom.hideDom(this.gridDomMap.pageDiv_3)}};FDPaginationView.prototype.show=function(){if(this.gridDomMap.pageDiv_3){FDLib.dom.showDom(this.gridDomMap.pageDiv_3)}};FDPaginationView.prototype.buildPagination=function(){if(!this.gridDomMap.pageDiv_3){this._initPaginDom();this._buidlPaginButtons();this._appendPaginToDiv()}};FDPaginationView.prototype._initPaginDom=function(){this.gridDomMap.pageDiv_3=document.createElement(FDTag.DIV);this.gridDomMap.pageDiv_3.className="pui-paginator ui-widget-header";this.paginInfoDiv=document.createElement(FDTag.DIV)};FDPaginationView.prototype._appendPaginToDiv=function(){this.gridDomMap.gridDiv_3.appendChild(this.gridDomMap.pageDiv_3)};FDPaginationView.prototype._buidlPaginButtons=function(){if(this.options.showPaging){this._buildPageSizeSelector();this._buildFirstPageButton();this._buildPrePageButton();this._buildNextPageButton();this._buildLastPageButton();this._buildResultInfo()}if(this.options.showSetting){this._buildSettingButton()}if(!this.options.showPaging&&!this.options.showSetting){this.hide()}};FDPaginationView.prototype._buildPageSizeSelector=function(){var b=document.createElement(FDTag.SPAN);b.className="pui-paginator-last pui-paginator-element";var a=this;this.pageSizeSelect=new FDSelectBox({items:this._getPageSizeItems(),showDefault:false});this.pageSizeSelect.addEvent("change",function(){a.options.pageSize=this.value;a.options.pageIndex=1;a.grid.refresh()});this.pageSizeSelect.renderToDom(b);this.gridDomMap.pageDiv_3.appendChild(b)};FDPaginationView.prototype._getPageSizeItems=function(){var b=this.options.pageSizeParam;var a=[];FDLib.util.each(b,function(c){a.push({value:c,text:"每页"+c+"条"})});return a};FDPaginationView.prototype._buildFirstPageButton=function(b,c){var a=this;this.firstBtn=this._createButton({btnClassName:"pui-paginator-first pui-paginator-element ui-state-default ui-corner-all",iconClassName:"ui-icon ui-icon-seek-first",title:"首页"});FDLib.event.addEvent(this.firstBtn,"click",function(){a.grid.moveFirst()});this.gridDomMap.pageDiv_3.appendChild(this.firstBtn)};FDPaginationView.prototype._buildPrePageButton=function(b,c){var a=this;this.prevBtn=this._createButton({btnClassName:"pui-paginator-prev pui-paginator-element ui-state-default ui-corner-all",iconClassName:"ui-icon ui-icon-seek-prev",title:"上一页"});FDLib.event.addEvent(this.prevBtn,"click",function(){a.grid.movePreview()});this.gridDomMap.pageDiv_3.appendChild(this.prevBtn)};FDPaginationView.prototype._buildNextPageButton=function(b,c){var a=this;this.nextBtn=this._createButton({btnClassName:"pui-paginator-next pui-paginator-element ui-state-default ui-corner-all",iconClassName:"ui-icon ui-icon-seek-next",title:"下一页"});FDLib.event.addEvent(this.nextBtn,"click",function(){a.grid.moveNext()});this.gridDomMap.pageDiv_3.appendChild(this.nextBtn)};FDPaginationView.prototype._buildLastPageButton=function(b,c){var a=this;this.lastBtn=this._createButton({btnClassName:"pui-paginator-last pui-paginator-element ui-state-default ui-corner-all",iconClassName:"ui-icon ui-icon-seek-end",title:"尾页"});FDLib.event.addEvent(this.lastBtn,"click",function(){a.grid.moveLast()});this.gridDomMap.pageDiv_3.appendChild(this.lastBtn)};FDPaginationView.prototype._createButton=function(a){var b=document.createElement(FDTag.SPAN);b.className=a.btnClassName;var c=document.createElement(FDTag.SPAN);c.className=a.iconClassName;c.innerHTML="p";b.appendChild(c);if(a.title){b.setAttribute("title",a.title)}FDLib.event.addEvent(b,"mouseover",function(d){if(!FDLib.dom.hasClass(b,"ui-state-disabled")){FDLib.dom.addClass(b,"ui-state-hover")}d.stopPropagation()});FDLib.event.addEvent(b,"mouseout",function(d){FDLib.dom.removeClass(b,"ui-state-hover");d.stopPropagation()});return b};FDPaginationView.prototype._buildResultInfo=function(){this.paginInfoDiv=document.createElement(FDTag.SPAN);this.gridDomMap.pageDiv_3.appendChild(this.paginInfoDiv)};FDPaginationView.prototype._buildSettingButton=function(){var a=this;var b=this._createNormalButton("设置");FDLib.event.addEvent(b,"click",function(){a.settingView.showWin()});this.gridDomMap.pageDiv_3.appendChild(b)};FDPaginationView.prototype._createNormalButton=function(b){var a=document.createElement(FDTag.SPAN);a.className="pui-paginator-last pui-paginator-element ui-state-default ui-corner-all";a.innerHTML=b;FDLib.event.addEvent(a,"mouseover",function(c){FDLib.dom.addClass(a,"ui-state-hover");c.stopPropagation()});FDLib.event.addEvent(a,"mouseout",function(c){FDLib.dom.removeClass(a,"ui-state-hover");c.stopPropagation()});return a};var FDRowSelectView=function(a,b){FDLib.implement(this,Cell);this.selectOption=a;this.options=b;this.id=b.id;this.grid=b.getGrid();a.name=a.name||"grid_select_"+FDControl.generateCount()};FDRowSelectView.prototype.buildCellData=function(c,f,e,b){var a=this._buildSelector(c,e,b);f.appendChild(a);var d=this.selectOption.onload;if(FDLib.util.isFunction(d)){d(c,a,e,b)}f.style.width="20px";f.setAttribute("align","center")};FDRowSelectView.prototype._buildSelector=function(f,g,e){var c=this;var b=this.selectOption.singleSelect?"radio":"checkbox";var a=this._buildSelectInput(b,f);var d=this.selectOption.onclick;a.onclick=function(){if(FDLib.util.isFunction(d)){d(f,a,g,e)}if(this.checked){c.grid._doSelectHandler(a,e)}else{c.grid._doNoSelectedHandler(a,e)}if(c.selectOption.cache){if(a.type=="radio"){c.grid.resetSelectCache()}c.grid.getSelectCache()[this.value]=this.checked?f:false}};a.setSelect=function(h){a.checked=!!h;a.onclick()};if(a.checked){c.grid._doSelectHandler(a,e)}else{c.grid._doNoSelectedHandler(a,e)}return a};FDRowSelectView.prototype._buildSelectInput=function(c,d){var a=document.createElement(FDTag.INPUT);a.setAttribute("type",c);a.setAttribute("name",this.selectOption.name);a.style.cursor="pointer";var b=d[this.id];if(b){a.value=b}if(this.selectOption.cache){a.checked=this.grid.isInCache(d,this.id)}return a};var FDTableView=function(a,b){FDLib.implement(this,View);this.each=FDLib.util.each;this.options=a;this.grid=b;this.resultData=null;this.headView=this._buildHeadView();this.cellViews=this._buildCellView();this.paginationView=this._buildPaginationView();this.gridDomMap=this.options.gridDomMap;this.renderTo(this.options.domId)};FDTableView.prototype.getTableView=function(){return this};FDTableView.prototype.processData=function(a){this.resultData=a;this.removeAllData();if((this.resultData[GlobalParams.serverRowsName]||[]).length>0){this._buildGridData()}else{this.showNoResultMsg()}this._refreshPaginationInfo(a)};FDTableView.prototype.renderTo=function(b){this._initTableDom();var a=FDLib.getEl(b)||document.body;a.appendChild(this.gridDomMap.gridDiv_3)};FDTableView.prototype.removeAllData=function(){this.gridDomMap.tbody_0.parentNode.removeChild(this.gridDomMap.tbody_0);this.gridDomMap.tbody_0=document.createElement(FDTag.TBODY);this.gridDomMap.table_1.appendChild(this.gridDomMap.tbody_0)};FDTableView.prototype._setTrStyle=function(b,c){var a="ui-widget-content";if(c%2===0){a+=" pui-datatable-even"}else{a+=" pui-datatable-odd"}b.className=a};FDTableView.prototype._buildHeadView=function(){return new FDHeadView(this.options,this.grid)};FDTableView.prototype._buildPaginationView=function(){return new FDPaginationView(this.options,this.grid)};FDTableView.prototype._refreshPaginationInfo=function(a){this.paginationView.refreshPaginationInfo(a)};FDTableView.prototype._buildGridData=function(){this.hideTable();var b=this.resultData[GlobalParams.serverRowsName]||[];var a=this;this.each(b,function(c,d){a.insertRow(d,c)});this.showTable()};FDTableView.prototype.showNoResultMsg=function(){var a=this.gridDomMap.tbody_0.insertRow(0);var c=a.insertCell(0);var b=this.getColsLen();c.innerHTML=this.options.noDataText;c.setAttribute("colspan",b);c.setAttribute("align","center")};FDTableView.prototype.getColsLen=function(){var b=this.options.columns.length;var a=this.options.selectOption||{};if(a.singleSelect||a.multiSelect){b++}if(this.options.actionButtons.length>0){b++}return b};FDTableView.prototype.insertRow=function(c,b){var a=this.gridDomMap.tbody_0.insertRow(c);this._setTrEvent(a,b,c);this._setTrStyle(a,c);this.options.rowRender(b,a,c);this._buildRowCellsHtml(b,a,c)};FDTableView.prototype._setTrEvent=function(c,b,e){var a=this;var d=this.options.onClickRow;FDLib.event.addEvent(c,"click",function(){a.grid._bindClickRowClass(c);d(b,e)})};FDTableView.prototype._clearAllSelected=function(b){var c=this.gridDomMap.tbody_0.rows;var a=FDLib.dom;FDLib.util.each(c,function(d){if(a.hasClass(d,b)){a.removeClass(d,b);return false}})};FDTableView.prototype._buildRowCellsHtml=function(b,a,c){this.each(this.cellViews,function(e,d){var f=a.insertCell(d);e.buildCellData(b,f,c,a)})};FDTableView.prototype.showTable=function(){this.gridDomMap.table_1.style.display=""};FDTableView.prototype.hideTable=function(){this.gridDomMap.table_1.style.display="none"};FDTableView.prototype._buildCellView=function(){var c=this.options.columns;var a=[];var b=this;a=this._addRowSelectAbility(a);this.each(c,function(d){a.push(new FDCellView(d,b.options))});a=this._addActionButtonAbility(a);return a};FDTableView.prototype._addRowSelectAbility=function(a){if(this.multiSelect()||this.singleSelect()){a.push(new FDRowSelectView(this.options.selectOption,this.options))}return a};FDTableView.prototype._addActionButtonAbility=function(a){var b=this.options.actionButtons;if(FDLib.util.isArray(b)&&b.length>0){a.push(new FDButtonView(this.options.actionColumnConfig,this.options))}return a};FDTableView.prototype.multiSelect=function(){return this.options.selectOption.multiSelect};FDTableView.prototype.singleSelect=function(){return this.options.selectOption.singleSelect};FDTableView.prototype._initTableDom=function(){this._initFrame();this._initHeadDom();this._initPaginDom();this.setStyle();this._initTableSize()};FDTableView.prototype._initFrame=function(){this.gridDomMap.gridDiv_3=document.createElement(FDTag.DIV);this.gridDomMap.tableDiv_2=document.createElement(FDTag.DIV);this.gridDomMap.table_1=document.createElement(FDTag.TABLE);this.gridDomMap.tbody_0=document.createElement(FDTag.TBODY);this.gridDomMap.table_1.appendChild(this.gridDomMap.tbody_0);this.gridDomMap.tableDiv_2.appendChild(this.gridDomMap.table_1);this.gridDomMap.gridDiv_3.appendChild(this.gridDomMap.tableDiv_2)};FDTableView.prototype.setStyle=function(){this.gridDomMap.gridDiv_3.className="pui-datatable ui-widget";this.gridDomMap.tbody_0.className="pui-datatable-data";this.gridDomMap.tableDiv_2.className="pui-datatable-scrollable-body"};FDTableView.prototype._initHeadDom=function(){this.headView.buildHead()};FDTableView.prototype._initPaginDom=function(){this.paginationView.buildPagination()};FDTableView.prototype._initTableSize=function(){var b=this.options.width;var a=this.options.height;if(b){this.gridDomMap.gridDiv_3.style.width=FDLib.util.getPX(b)}if(a){this.gridDomMap.tableDiv_2.style.height=FDLib.util.getPX(a)}};FDTableView.prototype._resetHeight=function(){this.gridDomMap.tableDiv_2.style.height="auto"};FDLib.ajax={request:function(c){var b=c.url;var e=c.params||{};var f=c.success||function(g){alert(g)};var a=c.error||function(g){alert("数据请求失败")};var d=this.createXhrObject();d.onreadystatechange=function(){if(d.readyState!==4){return}var g=d.status;var h="";try{h=JSON.parse(d.responseText)}catch(i){h=JSON.parse('{"message":"后台请求错误(status:'+g+')"}')}if(g===200||g===0){f(h)}else{a(h)}};d.open("POST",b,false);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.send(this.formatParam(e)||null)},formatParam:function(d){var e=[];for(var b in d){var c=d[b];var a=b+"="+encodeURIComponent(c);if(this._isArray(c)){a=this._formatArrParam(b,c)}if(a){e.push(a)}}if(e.length==0){return""}return e.join("&")},_formatArrParam:function(d,e){if(e.length==0){return""}var b=[];for(var c=0,a=e.length;c<a;c++){b.push(d+"="+encodeURIComponent(e[c]))}return b.join("&")},_isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},createXhrObject:function(){var b=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var c=0,a=b.length;c<a;c++){try{b[c]()}catch(d){continue}this.createXhrObject=b[c];return b[c]()}throw new Error("创建XHR对象失败")}};var FDModel=function(){FDLib.implement(this,Model)};FDModel.prototype={postData:function(a,b,c){FDLib.ajax.request({url:a,params:b,success:c,error:function(d){FDWindow.alert(d.message)}})}};var GlobalParams={requestPageIndexName:"pageIndex",requestPageSizeName:"pageSize",requestSortName:"sortname",requestOrderName:"sortorder",serverPageIndexName:"pageIndex",serverPageSizeName:"pageSize",serverTotalName:"total",serverRowsName:"rows",defalutView:FDTableView,defalutModel:FDModel};var FDGrid=function(a){this.viewInstance;this.modelInstance;this.options=FDLib.util.apply(this.getOptions(),a);if(!this.getPageSize()){this.setPageSize(this.options.pageSizeParam[0])}this.registView();this.registModel();if(this.options.loadSearch){this.search()}};FDGrid.prototype={getOptions:function(){var a=this;return{domId:"",url:"",id:null,width:"",height:"",noDataText:"无查询结果",columns:[],columnDefaultStyle:{width:"100px"},fitColumns:true,actionColumnConfig:{text:"操作",style:{textAlign:"center"}},actionButtons:[],selectOption:{multiSelect:false,singleSelect:false,onclick:function(d,b,c,e){},onload:function(d,b,c,e){},hideCheckAll:false,cache:false},selectCache:{},gridDomMap:{tbody_0:null,table_1:null,tableDiv_2:null,gridDiv_3:null,headThead_0:null,pageDiv_3:null,paginTable_2:null,paginTfoot_1:null},rowRender:function(b,c,d){},view:GlobalParams.defalutView,model:GlobalParams.defalutModel,showPaging:true,showSetting:true,pageCount:0,pageIndex:1,total:0,pageSizeParam:[10,20,30],pageSize:0,schData:{},result:null,data:null,sortName:null,sortOrder:"DESC",loadSearch:true,getGrid:function(){return a},selectRowClassName:"ui-state-active",clickRowClassName:"ui-state-highlight",onBeforeLoad:function(b){return true},onLoadSuccess:function(b){return b},afterRefresh:function(b){},onClickRow:function(b,c){}}},registView:function(){var a=this.options.view;this.viewInstance=new a(this.options,this)},_initDecorators:function(c){var b=this.options.decorators;var a=this;FDLib.util.each(b,function(d){c=new d(c,a)});return c},registModel:function(){var a=this.options.model;this.modelInstance=new a()},search:function(a){if(this.options.url){this.options.schData=a||{};this.options.pageIndex=1}this.resetSelectCache();this.refresh()},resetSelectCache:function(){if(this.isSelectable()){this.options.selectCache={}}},getSelectCache:function(){return this.options.selectCache},loadData:function(a){this.options.data=a;this.resetParam();this.refresh()},getData:function(){return this.options.result},getRowData:function(a){return this.getRows()[a]},getRows:function(){return this.getData()[GlobalParams.serverRowsName]||[]},getChecked:function(){if(this.multiSelect()){var c=this.options.id;var d=[];var g=this.getRows();var b=this;var e=this.options.selectOption.cache;if(e){var a=this.getSelectCache();for(var f in a){if(a[f]){d.push(a[f])}}}FDLib.util.each(g,function(l,k){var h=b.getSelectorByRowIndex(k);var j=b.isInCache(l,c);if(h&&h.checked&&!j){d.push(l)}});return d}},isInCache:function(c,a){if(!a){return false}var b=c[a];return !!this.options.selectCache[b]},getCheckedLength:function(){var a=this.getChecked();if(!a){return 0}return a.length},getSelected:function(){if(this.singleSelect()){var e=this.getRows();var b=this;var c=this.options.selectOption.cache;if(c){var a=this.getSelectCache();for(var d in a){if(a[d]){return a[d]}}}return FDLib.util.each(e,function(h,g){var f=b.getSelectorByRowIndex(g);if(f&&f.checked){return h}})}},checkAll:function(){if(this.multiSelect()){var a=this._getSelectAllInput();if(a){a.checked="checked";a.onclick()}}},uncheckAll:function(){if(this.multiSelect()){var a=this._getSelectAllInput();if(a){a.checked="";a.onclick()}}},selectRow:function(a){this.setSelected(a)},setUrl:function(a){this.options.url=a},selectRecord:function(e){var b=this.getTableTR();var d=b.length;for(var c=0;c<d;c++){var a=this.getSelectorByRowIndex(c);if(a.value==e){this.setSelected(c);break}}},checkRow:function(a){this.setSelected(a)},uncheckRow:function(a){this.setNoSelected(a)},clearChecked:function(){this.uncheckAll()},_doSelectHandler:function(a,b){if(a.disabled){return}if(this.singleSelect()){this._bindSingleSelectRow(b)}FDLib.dom.removeClass(b,this.options.clickRowClassName);FDLib.dom.addClass(b,this.options.selectRowClassName)},_noSelectedHandler:function(a,b){var d=this.getTableTR();if(a.disabled){return}var c=d[b];this._doNoSelectedHandler(a,c)},_doNoSelectedHandler:function(a,b){if(a.disabled){return}a.checked="";FDLib.dom.removeClass(b,this.options.selectRowClassName)},_bindSingleSelectRow:function(a){if(this.lastRadioSelectedTR){FDLib.dom.removeClass(this.lastRadioSelectedTR,this.options.selectRowClassName)}this.lastRadioSelectedTR=a},_bindClickRowClass:function(a){if(this.lastClickedTR){FDLib.dom.removeClass(this.lastClickedTR,this.options.clickRowClassName)}if(FDLib.dom.hasClass(a,this.options.selectRowClassName)){return}this.lastClickedTR=a;FDLib.dom.addClass(a,this.options.clickRowClassName)},getTableTR:function(){return this.options.gridDomMap.tbody_0.rows},buildParam:function(){var a=this.options.schData||{};a[GlobalParams.requestPageIndexName]=this.getPageIndex();a[GlobalParams.requestPageSizeName]=this.getPageSize();if(this.options.sortName){a[GlobalParams.requestSortName]=this.options.sortName;a[GlobalParams.requestOrderName]=this.options.sortOrder}return a},sort:function(b,a){this.options.sortName=b;this.options.sortOrder=a;this.refresh()},getSortOrder:function(){return this.options.sortOrder},getSortName:function(){return this.options.sortName},getThead:function(){return this.options.gridDomMap.headThead_0},getTbody:function(){return this.options.gridDomMap.tbody_0},postData:function(){if(this.options.url){var d=this.buildParam();var b=this;var c=this.options.onBeforeLoad(d);if(c){this.modelInstance.postData(this.options.url,d,function(e){b.options.result=b.options.onLoadSuccess(e);b.callViewsProcess()})}}else{if(this.options.data){var a=this.requestLocal(this.getPageIndex(),this.getPageSize());a=this.options.onLoadSuccess(a);this.options.result=a;this.callViewsProcess()}}this.options.afterRefresh(this.options.result)},getPageIndex:function(){return this.options.pageIndex},getPageSize:function(){return this.options.pageSize},setPageIndex:function(a){this.options.pageIndex=a},setPageSize:function(a){this.options.pageSize=a},requestLocal:function(a,c){var d=[];var f=this.options.data;var b=1,e=0;if(this.options.showPaging){b=parseInt((a-1)*c);e=f.length;d=f.slice(b,b+c)}else{d=f}var g={};g[GlobalParams.serverRowsName]=d;g[GlobalParams.serverPageIndexName]=a;g[GlobalParams.serverPageSizeName]=c;g[GlobalParams.serverTotalName]=e;return g},callViewsProcess:function(){this.viewInstance.processData(this.options.result)},refresh:function(){this.postData();this.reset()},reload:function(){this.resetParams();this.search()},resetParams:function(){this.options.pageIndex=1;this.options.schData={}},reset:function(){if(this.multiSelect()){var a=this._getSelectAllInput();if(a){a.checked=""}}},resetParam:function(){this.options.pageIndex=1},deleteRow:function(c){var b=this.options.data||{};var a=b[GlobalParams.serverRowsName];if(a.length>c){a.splice(c,1);this.refresh()}},isSelectable:function(){return this.singleSelect()||this.multiSelect()},isSelectStatus:function(){return this.isSelectable()},singleSelect:function(){var a=this.options.selectOption;return a.singleSelect},multiSelect:function(){var a=this.options.selectOption;return a.multiSelect},_getSelectAllInput:function(){if(this.multiSelect()){return this.checkAllInput}},getSelectorByRowIndex:function(b){if(this.isSelectable()){var a=this.getTableTR();return this._getInput(a,b)}},_getInput:function(b,d){var c=b[d];var a=c.cells[0];return a.getElementsByTagName("input")[0]},_couldOperateSelector:function(a){return a&&!a.disabled},_getTable:function(){return this.options.gridDomMap.table_1},setSelected:function(b){var a=this.getSelectorByRowIndex(b);if(a.disabled){return}a.checked="checked";a.onclick()},setNoSelected:function(b){var a=this.getSelectorByRowIndex(b);if(a.disabled){return}a.checked="";a.onclick()},clearSelected:function(){if(this.singleSelect()){var b=this.getTableTR();var d=b.length;var e=null;for(var c=0;c<d;c++){e=b[c];var a=this.getSelectorByRowIndex(c);if(a.checked){this._doNoSelectedHandler(a,e);break}}}},getDataLength:function(){return this.getRows().length},setRowDisabled:function(b){var a=this.getSelectorByRowIndex(b);if(a){a.disabled="disabled"}},setRowEnabled:function(b){var a=this.getSelectorByRowIndex(b);if(a){a.disabled=""}},moveFirst:function(){if(this.options.pageIndex!=1){this.options.pageIndex=1;this.refresh()}},movePreview:function(){if(this.options.pageIndex>1){this.options.pageIndex--;this.refresh()}},moveNext:function(){if(this.options.pageIndex<this.options.pageCount){this.options.pageIndex++;this.refresh()}},moveLast:function(){if(this.options.pageIndex!=this.options.pageCount){this.options.pageIndex=this.options.pageCount;this.refresh()}}};var FDTip=function(a){FDLib.implement(this,FDControl);this.options=FDLib.util.apply(this.getOptions(),a);this.delayTimeout=null;this.target=null;this.originalTitle=null;this.x=0;this.y=0;this.delay=this.options.delay;this.offsetX=this.options.offsetX;this.offsetY=this.options.offsetY;this.tipDiv=document.createElement(FDTag.DIV);this.tipDiv.style.display="none";this.tipDiv.className="pui-tooltip pui-tooltip-global ui-widget ui-widget-content ui-corner-all pui-shadow";document.body.appendChild(this.tipDiv)};FDTip.prototype={getOptions:function(){return{delay:500,offsetX:0,offsetY:15}},show:function(c,d,a,f){c=FDLib.event.formatEvent(c);this.target=c.target;this._backupTargetTitle();d=this._insureTextExist(d);if(this.delay===0){this.doShow(c,d);return}if(this.delayTimeout==null){var b=this;this.delayTimeout=setTimeout(function(){b.doShow(c,d,a,f)},this.delay)}},hide:function(){this._restoreTargetTitle();this.reset();this.tipDiv.style.display="none"},_insureTextExist:function(a){if(typeof a==="undefined"){a=this.originalTitle}return a},_backupTargetTitle:function(){if(this.target.title){this.originalTitle=this.target.title;this.target.title=""}},_restoreTargetTitle:function(){if(this.originalTitle){this.target.title=this.originalTitle;this.originalTitle=null}},doShow:function(b,c,a,d){this.tipDiv.innerHTML=c;this.x=this.x||b.pageX;this.y=this.y||b.pageY;this.tipDiv.style.left=(this.x+this.offsetX)+"px";this.tipDiv.style.top=(this.y+this.offsetY)+"px";this.tipDiv.style.display="block"},setXY:function(a,b){this.x=a;this.y=b},reset:function(){clearTimeout(this.delayTimeout);this.delayTimeout=null;this.originalTitle=null;this.x=0;this.y=0}};var FDTipUtil=(function(){var a=null;var c=FDLib.event;function b(){if(!a){a=new FDTip()}return a}return{addTip:function(g,f,d){if(!g){throw new Error("请传入正确的dom对象")}var e=b();c.addEvent(g,"mouseover",function(h){e.show(h,f)});c.addEvent(g,"mousemove",function(h){e.setXY(h.pageX,h.pageY)});c.addEvent(g,"mouseout",function(){e.hide()})}}})();var FDTreeDomView=function(a){this.options=a;this.childrenFieldName=a.childrenFieldName;this.valueFieldName=a.valueFieldName;this.textFieldName=a.textFieldName;this.onCheck=a.onCheck||function(){};this.selectedId=null;this.treePanel=this.buildTreePanel();this.togglers=[];this.idNodeMap={};this.idDataMap={}};FDTreeDomView.prototype={refresh:function(a){if(a){var b=this.buildUL(a,"pui-tree-container");this.treePanel.innerHTML="";this.treePanel.appendChild(b);this.render()}},hide:function(){FDLib.dom.hideDom(this.treePanel)},show:function(){FDLib.dom.showDom(this.treePanel)},buildUL:function(d,g,c){var f=document.createElement(FDTag.UL);f.className=g;for(var e=0,b=d.length;e<b;e++){var a=this.buildLi(d[e]);f.appendChild(a);if(c){a.parentLi=c}}return f},buildLi:function(d){var a=document.createElement(FDTag.LI);var f="pui-treenode"+(this._isOpen(d)?" pui-treenode-expanded":"");var c=this.buildNodeDisplay(d,a);a.appendChild(c);if(this.hasChild(d)){a.isParent=true;f+=" pui-treenode-parent";var e=this.getChildren(d);var b=this.buildChildren(e,a);a.toggler.childrenUL=b;a.appendChild(b)}a.className=f;this.storeNode(d,a);return a},buildChildren:function(c,a){var b=this.buildUL(c,"pui-treenode-children",a);b.style.display="none";return b},buildNodeDisplay:function(g,a){var b=document.createElement(FDTag.SPAN);b.className="pui-treenode-content pui-treenode-selectable";var f=this.buildToggler(g);var d=this.buildIcon(g,f);var e=this.buildCheckbox(g);var c=this.buildLabel(g,f);this.togglers.push(f);b.appendChild(f);if(d){b.appendChild(d)}if(e){b.appendChild(e)}b.appendChild(c);a.toggler=f;a.icon=d;a.lab=c;return b},storeNode:function(b,a){this.idNodeMap[this.getId(b)]=a},getNode:function(a){return this.idNodeMap[a]},buildToggler:function(d){var b="pui-tree-toggler ui-icon "+((d.state&&"open"==d.state)?this.getOpenClassName():this.getCloseClassName());if(!this.hasChild(d)){b="pui-treenode-leaf-icon"}var a=this._createNodeSpan(b);var c=this;a.onclick=function(){c.toggle(this,d)};return a},buildIcon:function(e,d){var a=e.iconCls;if(a){var c="pui-treenode-icon ui-icon "+(a?a:"");var b=this._createNodeSpan(c);FDLib.event.addEvent(b,"click",function(){d.onclick()});return b}return null},buildLabel:function(g,f){var c="pui-treenode-label ui-corner-all";var b=this._createNodeSpan(c,this.getText(g));var h=this.options.clickToggle;var d=this;var a=true;var e=this.options.hoverEffectHandler;if(FDLib.util.isFunction(e)){a=e(g,b)}if(a){FDLib.addHoverEffect(b)}b.onclick=function(){if(h){f.onclick()}if(d.options.onclick){d.options.onclick(g)}d.setClickHighlight(b,g)};return b},buildCheckbox:function(d,a){if(this.options.checkable){var b=this;var c=document.createElement(FDTag.INPUT);c.type="checkbox";c.value=d[this.valueFieldName];c.data=d;c.onclick=function(){b.onCheck(d,this.checked);b.checkChildren(this,d,this.checked)};return c}},checkChildren:function(d,g,h){var c=this.getNode(g[this.valueFieldName]);var b=c.getElementsByTagName("input");for(var e=0,a=b.length;e<a;e++){var f=b[e];if(d==f){continue}f.checked=h;this.onCheck(f.data,h)}},getId:function(a){var b=a[this.valueFieldName];if(!b){a[this.valueFieldName]="tree_node_"+FDControl.generateCount()}return a[this.valueFieldName]},storeData:function(a){var b=this.getId(a);this.idDataMap[b]=a},getRowDataById:function(a){return this.idDataMap[a]},getText:function(a){if(this.options.render){return this.options.render(a)}return a[this.textFieldName]},getOpenClassName:function(){return"ui-icon-triangle-1-s"},getCloseClassName:function(){return"ui-icon-triangle-1-e"},expandParent:function(b){var a=b.parentLi;if(b&&a){this.expandByLi(a);this.expandParent(a)}},expandByLi:function(a){var b=a.toggler;if(a&&a.isParent&&b){this.expand(b)}},select:function(d,c){this.selectedId=d;var b=this.getRowDataById(d);var a=this.getNode(d);this.expandByLi(a);this.expandParent(a);c&&c(b);a.lab.onclick()},getSelected:function(){return this.getRowDataById(this.selectedId)},getChecked:function(f){var d=[];var e=this.treePanel.getElementsByTagName("input");for(var b=0,a=e.length;b<a;b++){var c=e[b];if(c.checked){d.push(c.data)}}return d},getUnChecked:function(){var d=[];var e=this.treePanel.getElementsByTagName("input");for(var b=0,a=e.length;b<a;b++){var c=e[b];if(!c.checked){d.push(c.data)}}return d},check:function(f,h){var g=this.treePanel.getElementsByTagName("input");for(var d=0,a=g.length;d<a;d++){var e=g[d];for(var c=0,b=f.length;c<b;c++){if(f[c]==e.value){e.checked=true;this.onCheck(e.data,e.checked);h&&h(e.data,e)}}}},uncheck:function(f,h){var g=this.treePanel.getElementsByTagName("input");for(var d=0,a=g.length;d<a;d++){var e=g[d];for(var c=0,b=f.length;c<b;c++){if(f[c]==e.value){e.checked=false;this.onCheck(e.data,e.checked);h&&h(e.data,e)}}}},checkAll:function(e){var d=this.treePanel.getElementsByTagName("input");for(var b=0,a=d.length;b<a;b++){var c=d[b];c.checked=true;this.onCheck(c.data,c.checked);e&&e(c.data,c)}},uncheckAll:function(e){var d=this.treePanel.getElementsByTagName("input");for(var b=0,a=d.length;b<a;b++){var c=d[b];c.checked=false;this.onCheck(c.data,c.checked);e&&e(c.data,c)}},checkOthers:function(e){var d=this.treePanel.getElementsByTagName("input");for(var b=0,a=d.length;b<a;b++){var c=d[b];c.checked=!c.checked;this.onCheck(c.data,c.checked);e&&e(c.data,c)}},setClickHighlight:function(d,c){var a=true;var b=this.options.highlightHandler;if(FDLib.util.isFunction(b)){a=b(c,d)}if(a){this.doClickHighlight(d)}},doClickHighlight:function(a){if(this.lastClickSpan){FDLib.dom.removeClass(this.lastClickSpan,"ui-state-highlight")}this.lastClickSpan=a;FDLib.dom.addClass(a,"ui-state-highlight")},toggle:function(b,a){if(this._isOpen(b)){this.collapse(b);a.state="closed"}else{this.expand(b);a.state="open"}},expandAll:function(){for(var b=0,a=this.togglers.length;b<a;b++){this.expand(this.togglers[b])}},collapseAll:function(){for(var b=0,a=this.togglers.length;b<a;b++){this.collapse(this.togglers[b])}},expand:function(b){b.state="open";var a=b.childrenUL;if(a){FDLib.dom.removeClass(b,this.getCloseClassName());FDLib.dom.addClass(b,this.getOpenClassName());a.style.display="block"}},collapse:function(b){b.state="close";var a=b.childrenUL;if(a){FDLib.dom.removeClass(b,this.getOpenClassName());FDLib.dom.addClass(b,this.getCloseClassName());a.style.display="none"}},_isOpen:function(a){if(!a.state){return false}return a.state=="open"},_createNodeSpan:function(b,c){var a=document.createElement(FDTag.SPAN);a.className=b;if(c){a.innerHTML=c}return a},buildTreePanel:function(){var a=document.createElement(FDTag.DIV);a.className="pui-tree ui-widget ui-widget-content ui-corner-all";if(!this.options.showBorder){a.style.border="0px"}return a},hasChild:function(a){return this.getChildren(a).length>0},getChildren:function(a){return a[this.childrenFieldName]||[]},render:function(){if(FDRight.checkByCode(this.options.operateCode)){var a=FDLib.getEl(this.options.domId);a.innerHTML="";a.appendChild(this.treePanel)}}};var FDTree=function(b){FDLib.implement(this,FDControl);this.options=FDLib.util.apply(this.getOptions(),b);var a=this.options.view;this.treeView=new a(this.options);this.reload()};FDTree.prototype={getOptions:function(){return{domId:null,url:"",params:{},onclick:function(a){},onCheck:function(b,a){},data:null,render:null,view:FDTreeDomView,valueFieldName:"id",textFieldName:"text",childrenFieldName:"children",checkable:false,showBorder:true,clickToggle:false,highlightHandler:function(a,b){return true},hoverEffectHandler:function(b,a){return true}}},select:function(a){this.treeView.select(a)},check:function(a,b){this.treeView.check(a,b)},uncheck:function(a,b){this.treeView.uncheck(a,b)},checkAll:function(a){this.treeView.checkAll(a)},uncheckAll:function(a){this.treeView.uncheckAll(a)},checkOthers:function(a){this.treeView.checkOthers(a)},getSelected:function(){return this.treeView.getSelected()},getChecked:function(){return this.treeView.getChecked()},getUnChecked:function(){return this.treeView.getUnChecked()},setData:function(a){if(FDLib.util.isObject(a)){this.options.data=a;this.reload()}},expandAll:function(a){this.treeView.expandAll(a)},collapseAll:function(a){this.treeView.collapseAll(a)},reload:function(c){var b=this;var a=this.options;a.params=c||{};if(a.url){FDLib.ajax.request({url:a.url,params:a.params,success:function(d){a.data=d;b.treeView.refresh(d)}})}else{b.treeView.refresh(a.data)}},hide:function(){this.treeView.hide()},show:function(){this.treeView.show()}};