var FDTabView=function(a,b){this.options=a;this.liStore={};this.tab=b;this.tabDiv=document.createElement(FDTag.DIV);this.tabDiv.className="pui-tabview ui-widget ui-widget-content ui-corner-all ui-hidden-container pui-tabview-top";this.ul=document.createElement(FDTag.UL);this.ul.className="pui-tabview-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all";this.ul.style.height="32px";this.tabContent=document.createElement(FDTag.DIV);this.tabContent.className="pui-tabview-panels";this.tabDiv.appendChild(this.ul);this.tabDiv.appendChild(this.tabContent);this.checkedItem=null;this._buildTabEvent()};FDTabView.prototype={buildTab:function(a){this._buildTabItem(a);this._renderToDesDom()},show:function(){this.tabDiv.style.display="block"},hide:function(){this.tabDiv.style.display="none"},disable:function(b){this._selectOtherItem(b);b.disable=true;var a=this._getLiByValue(b.value);a.className=this._getDisabledClassName()},enable:function(b){b.disable=false;var a=this._getLiByValue(b.value);a.className=this._getLiClassName()},_getDisabledClassName:function(){return"ui-state-disabled"},removeAll:function(){this._hideAllItemContent();this.ul.innerHTML="";this.liStore={}},doRemoveItem:function(b){var c=b.value;this._hideItemContent(b);var a=this._getLiByValue(c);a.parentNode.removeChild(a);this._clearLiStore(c)},removeItem:function(a){if(this._isAbleOperate(a)){this._selectOtherItem(a);this.doRemoveItem(a)}},showItemByValue:function(b){var a=this._getItemByValue(b);if(a){if(this._isAbleOperate(a)){this._processClickEvent(a)}if(this._isAbleOperate(a)&&!this.isChecked(a)){this._selectItem(a);this._processChangeEvent(a)}this._refresh(a)}},_unselectAllItems:function(){var a=this._getItemStore();for(var c in a){var b=a[c];if(this._isAbleOperate(b)){this._unselectItem(b)}}},_isAbleOperate:function(a){return a&&!a.disable},_selectItem:function(a){if(a){this._unselectAllItems();a.checked=true;FDLib.dom.addClass(this._getLiByValue(a.value),this._getSelectClassName());this._showItemContent(a)}},_unselectItem:function(a){a.checked=false;FDLib.dom.removeClass(this._getLiByValue(a.value),this._getSelectClassName());this._hideItemContent(a)},isChecked:function(a){return a&&a.checked},_getSelectClassName:function(){return"pui-tabview-selected ui-state-active"},_getLiClassName:function(){return"ui-state-default ui-corner-top"},_selectOtherItem:function(d){var b=this._getLiByValue(d.value);if(this.isChecked(d)){var a=b.previousSibling||b.nextSibling;if(a){var c=a.getAttribute("value");this.showItemByValue(c)}}},_renderToDesDom:function(){if(FDRight.checkByCode(this.options.operateCode)){var a=FDLib.getEl(this.options.domId);a.appendChild(this.tabDiv);this._selectItem(this.checkedItem||this.options.items[0])}},_buildTabItem:function(b){var a=this;FDLib.util.each(b,function(d){var c=a._buildLI(d);a.ul.appendChild(c);a._storeLI(c,d.value);a._buildItemContent(d)})},_storeLI:function(a,b){this.liStore[b]=a},_buildLI:function(b){var a=document.createElement(FDTag.LI);a.className=this._getLiClassName();a.setAttribute("value",b.value);a.innerHTML=FDLib.string.format(FDTabView.aTemplate,{text:b.text});this._addHoverEffect(a,b);if(b.closeable){this._buildCloseButton(a)}if(b.checked){this.checkedItem=b}return a},_addHoverEffect:function(a,d){var b="ui-state-hover";var c=this;FDLib.event.addEvent(a,"mouseover",function(){if(c._isAbleOperate(d)){FDLib.dom.addClass(a,b)}});FDLib.event.addEvent(a,"mouseout",function(){FDLib.dom.removeClass(a,b)})},_buildCloseButton:function(a){var b=document.createElement(FDTag.SPAN);b.className="ui-icon ui-icon-close";a.appendChild(b)},_buildItemContent:function(b){var a=b.contentDiv;a.className="pui-tabview-panel ui-widget-content ui-corner-bottom";this.tabContent.appendChild(a);if(b.checked){this._showItemContent(b)}else{this._hideItemContent(b)}},_clearLiStore:function(a){delete this.liStore[a]},_buildTabEvent:function(){var b=this;var a=this.options.isHover?"mouseover":"click";FDLib.event.addBatchEvent({superDom:this.ul,tagName:"A",eventName:a,handler:function(c){b._showItemHandler(c)}});FDLib.event.addBatchEvent({superDom:this.ul,tagName:"SPAN",eventName:"click",handler:function(c){b._closeItemHandler(c)}})},_showItemHandler:function(c){var a=c.parentNode;var b=a.getAttribute("value");this.showItemByValue(b)},_closeItemHandler:function(c){var a=c.parentNode;var b=a.getAttribute("value");if(this._isAbleOperate(this._getItemByValue(b))){this.tab.removeItemByValue(b)}},_processClickEvent:function(b){var a=b.onclick;if(FDLib.util.isFunction(a)){a(this.tab,b)}},_processChangeEvent:function(b){var a=b.onchange;if(FDLib.util.isFunction(a)){a(this.tab,b)}},_refresh:function(b){if(this._hasIframe(b)){var a=b.iframe;if(this._isNeedRefresh(a,b)){this._refreshIFrame(a,b)}}},_showItemContent:function(a){a.contentDiv.style.display="block"},_hideItemContent:function(a){a.contentDiv.style.display="none"},_hideAllItemContent:function(){var a=this._getItemStore();for(var b in a){this._hideItemContent(a[b])}},_hasIframe:function(a){return a.iframe},_isFirstLoad:function(a){return !a.src},_refreshIFrame:function(a,b){a.src=b.url},_isNeedRefresh:function(a,b){if(this._isFirstLoad(a)){return true}return(FDLib.util.isString(b.url)&&b.url&&b.isRefresh)},_getItemStore:function(){return this.options.itemStore},_getItemByValue:function(a){return this._getItemStore()[a]},_getLiByValue:function(a){return this.liStore[a]}};FDTabView.aTemplate='<a href="javascript:void(0);">{text}</a>';