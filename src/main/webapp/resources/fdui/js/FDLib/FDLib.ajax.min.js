FDLib.ajax={request:function(c){var b=c.url;var e=c.params||{};var f=c.success||function(g){alert(g)};var a=c.error||function(g){alert("数据请求失败")};var d=this.createXhrObject();d.onreadystatechange=function(){if(d.readyState!==4){return}var g=d.status;var h="";try{h=JSON.parse(d.responseText)}catch(i){h=JSON.parse('{"message":"后台请求错误(status:'+g+')"}')}if(g===200||g===0){f(h)}else{a(h)}};d.open("POST",b,false);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.send(this.formatParam(e)||null)},formatParam:function(d){var e=[];for(var b in d){var c=d[b];var a=b+"="+encodeURIComponent(c);if(this._isArray(c)){a=this._formatArrParam(b,c)}if(a){e.push(a)}}if(e.length==0){return""}return e.join("&")},_formatArrParam:function(d,e){if(e.length==0){return""}var b=[];for(var c=0,a=e.length;c<a;c++){b.push(d+"="+encodeURIComponent(e[c]))}return b.join("&")},_isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},createXhrObject:function(){var b=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var c=0,a=b.length;c<a;c++){try{b[c]()}catch(d){continue}this.createXhrObject=b[c];return b[c]()}throw new Error("创建XHR对象失败")}};