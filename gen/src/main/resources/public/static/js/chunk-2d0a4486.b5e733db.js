(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a4486"],{"067a":function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-container"},[t("el-form",{ref:"genForm",staticStyle:{width:"900px"},attrs:{model:e.clientParam,size:"mini","label-width":"200px"}},[t("el-form-item",{attrs:{label:"选择数据源",prop:"datasourceConfigId",rules:{required:!0,message:"请选择数据源"}}},[t("el-select",{staticStyle:{width:"500px"},attrs:{placeholder:"选择数据源"},on:{change:e.onDataSourceChange},model:{value:e.clientParam.datasourceConfigId,callback:function(a){e.$set(e.clientParam,"datasourceConfigId",a)},expression:"clientParam.datasourceConfigId"}},e._l(e.datasourceConfigList,(function(a){return t("el-option",{key:a.id,attrs:{label:a.dbName+"（"+a.host+"）",value:a.id}},[t("span",{staticStyle:{float:"left"}},[e._v(e._s(a.dbName+"（"+a.host+"）")+" ")]),e._v(" "),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t("el-link",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){return t.stopPropagation(),e.onDataSourceUpdate(a)}}}),e._v(" "),t("el-link",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),e.onDataSourceDelete(a)}}})],1)])})),1),e._v(" "),t("el-button",{attrs:{type:"text"},on:{click:e.onDataSourceAdd}},[e._v("新建数据源")])],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showTable,expression:"showTable"}],attrs:{required:"",label:"选择表"}},[t("el-table",{attrs:{data:e.tableListData,border:"","cell-style":e.cellStyleSmall(),"header-cell-style":e.headCellStyleSmall(),height:"350px"},on:{"selection-change":e.onTableListSelect}},[t("el-table-column",{attrs:{type:"selection"}}),e._v(" "),t("el-table-column",{attrs:{prop:"tableName",label:"表名"}}),e._v(" "),t("el-table-column",{attrs:{prop:"comment",label:"备注"}})],1)],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showTable,expression:"showTable"}],attrs:{required:"",label:"选择模板"}},[t("el-table",{attrs:{data:e.templateListData,border:"","cell-style":e.cellStyleSmall(),"header-cell-style":e.headCellStyleSmall()},on:{"selection-change":e.onTemplateListSelect}},[t("el-table-column",{attrs:{type:"selection"}}),e._v(" "),t("el-table-column",{attrs:{prop:"name",label:"模板名称"}})],1)],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showTable,expression:"showTable"}],attrs:{label:"包名（package）"}},[t("el-input",{attrs:{placeholder:"可选，如：com.gitee.xxx","show-word-limit":"",maxlength:"100"},model:{value:e.clientParam.packageName,callback:function(a){e.$set(e.clientParam,"packageName",a)},expression:"clientParam.packageName"}})],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showTable,expression:"showTable"}]},[t("el-button",{attrs:{type:"primary"},on:{click:e.onGenerate}},[e._v("生成代码")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.datasourceTitle,visible:e.datasourceDlgShow},on:{"update:visible":function(a){e.datasourceDlgShow=a}}},[t("el-form",{ref:"datasourceForm",attrs:{model:e.datasourceFormData,rules:e.datasourceRule,size:"mini","label-width":"120px"}},[t("el-form-item",{attrs:{label:"数据库类型"}},[t("el-select",{attrs:{filterable:"","default-first-option":""},model:{value:e.datasourceFormData.dbType,callback:function(a){e.$set(e.datasourceFormData,"dbType",a)},expression:"datasourceFormData.dbType"}},e._l(e.dbTypeConfig,(function(e){return t("el-option",{key:e.dbType,attrs:{label:e.label,value:e.dbType}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"Host",prop:"host"}},[t("el-input",{attrs:{placeholder:"地址","show-word-limit":"",maxlength:"100"},model:{value:e.datasourceFormData.host,callback:function(a){e.$set(e.datasourceFormData,"host",a)},expression:"datasourceFormData.host"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Port",prop:"port"}},[t("el-input",{attrs:{placeholder:"端口","show-word-limit":"",maxlength:"10"},model:{value:e.datasourceFormData.port,callback:function(a){e.$set(e.datasourceFormData,"port",a)},expression:"datasourceFormData.port"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Database",prop:"dbName"}},[t("el-input",{attrs:{placeholder:"数据库","show-word-limit":"",maxlength:"64"},model:{value:e.datasourceFormData.dbName,callback:function(a){e.$set(e.datasourceFormData,"dbName",a)},expression:"datasourceFormData.dbName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Username",prop:"username"}},[t("el-input",{attrs:{placeholder:"用户名","show-word-limit":"",maxlength:"100"},model:{value:e.datasourceFormData.username,callback:function(a){e.$set(e.datasourceFormData,"username",a)},expression:"datasourceFormData.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"Password",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"密码","show-word-limit":"",maxlength:"100"},model:{value:e.datasourceFormData.password,callback:function(a){e.$set(e.datasourceFormData,"password",a)},expression:"datasourceFormData.password"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"success"},on:{click:e.onDatasourceTest}},[e._v("测试连接")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.onDatasourceSave}},[e._v("保存")])],1)],1)],1)],1)},r=[],l={data:function(){return{showTable:!1,clientParam:{datasourceConfigId:"",tableNames:[],templateConfigIdList:[],packageName:""},datasourceConfigList:[],tableListData:[],templateListData:[],datasourceTitle:"新建连接",datasourceDlgShow:!1,datasourceFormData:{id:0,dbType:1,host:"",port:"",username:"",password:"",dbName:""},dbTypeConfig:[{label:"MySql",dbType:1},{label:"Oracle",dbType:2},{label:"SqlServer",dbType:3}],datasourceRule:{host:[{required:!0,message:"不能为空",trigger:"blur"}],port:[{required:!0,message:"不能为空",trigger:"blur"}],username:[{required:!0,message:"不能为空",trigger:"blur"}],password:[{required:!0,message:"不能为空",trigger:"blur"}],dbName:[{required:!0,message:"不能为空",trigger:"blur"}]}}},created:function(){this.loadDataSource(),this.loadTemplate()},methods:{loadDataSource:function(){var e=this;this.post("/datasource/list",{},(function(a){e.datasourceConfigList=a.data}))},loadTemplate:function(){var e=this;this.post("/template/list",{},(function(a){e.templateListData=a.data}))},onDataSourceAdd:function(){this.datasourceTitle="新建连接",this.datasourceFormData.id=0,this.datasourceDlgShow=!0},onTableListSelect:function(e){this.clientParam.tableNames=e.map((function(e){return e.tableName}))},onTemplateListSelect:function(e){this.clientParam.templateConfigIdList=e.map((function(e){return e.id}))},onDataSourceChange:function(e){var a=this;this.clientParam.datasourceConfigId=e,this.post("/datasource/table/".concat(e),{},(function(e){a.showTable=!0,a.tableListData=e.data}))},onDataSourceUpdate:function(e){this.datasourceTitle="修改连接",Object.assign(this.datasourceFormData,e),this.datasourceDlgShow=!0},onDataSourceDelete:function(e){this.confirm("确认要删除 ".concat(e.dbName," 吗？"),(function(a){var t={id:e.id};this.post("/datasource/del",t,(function(){a(),location.reload()}))}))},onGenerate:function(){var e=this;this.$refs.genForm.validate((function(a){if(a){if(0===e.clientParam.tableNames.length)return void e.tip("请勾选表","error");if(0===e.clientParam.templateConfigIdList.length)return void e.tip("请勾选模板","error");var t=JSON.stringify(e.clientParam);e.goRoute("result/".concat(t))}}))},onDatasourceTest:function(){var e=this;this.$refs.datasourceForm.validate((function(a){a&&e.post("/datasource/test",e.datasourceFormData,(function(a){e.tip("连接成功")}))}))},onDatasourceSave:function(){var e=this;this.$refs.datasourceForm.validate((function(a){a&&e.post("/datasource/test",e.datasourceFormData,(function(a){e.datasourceFormData.id?e.post("/datasource/update",e.datasourceFormData,(function(e){location.reload()})):e.post("/datasource/add",e.datasourceFormData,(function(a){e.tip("添加成功"),e.loadDataSource(),e.datasourceDlgShow=!1}))}))}))}}},s=l,i=t("2877"),n=Object(i["a"])(s,o,r,!1,null,null,null);a["default"]=n.exports}}]);